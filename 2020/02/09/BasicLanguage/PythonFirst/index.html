<!DOCTYPE html>













<html class="theme-next pisces" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: true,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="数据类型数字型数字型包括：  int：20 float：3.3 bool：True（True = 1, False = 0） complex：4+2j, complex(4, 2)  运算方式有：加(+)，减(-)，乘(*)，除-浮点(/)，除-整数(//)，取余(%)，乘方(**) 常用方法：  range(n)：产生一个从0到n的序列。 range(m, n)：产生一个从m到n的序列。 sum">
<meta name="keywords" content="Python">
<meta property="og:type" content="article">
<meta property="og:title" content="Python">
<meta property="og:url" content="https://withz.github.io/2020/02/09/BasicLanguage/PythonFirst/index.html">
<meta property="og:site_name" content="Withz">
<meta property="og:description" content="数据类型数字型数字型包括：  int：20 float：3.3 bool：True（True = 1, False = 0） complex：4+2j, complex(4, 2)  运算方式有：加(+)，减(-)，乘(*)，除-浮点(/)，除-整数(//)，取余(%)，乘方(**) 常用方法：  range(n)：产生一个从0到n的序列。 range(m, n)：产生一个从m到n的序列。 sum">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-05-21T03:00:58.569Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python">
<meta name="twitter:description" content="数据类型数字型数字型包括：  int：20 float：3.3 bool：True（True = 1, False = 0） complex：4+2j, complex(4, 2)  运算方式有：加(+)，减(-)，乘(*)，除-浮点(/)，除-整数(//)，取余(%)，乘方(**) 常用方法：  range(n)：产生一个从0到n的序列。 range(m, n)：产生一个从m到n的序列。 sum">






  <link rel="canonical" href="https://withz.github.io/2020/02/09/BasicLanguage/PythonFirst/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Python | Withz</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Withz</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">48</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">7</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">27</span></a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

  <a href="https://github.com/withz" class="github-corner" title="打开Github" aria-label="打开Github" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://withz.github.io/2020/02/09/BasicLanguage/PythonFirst/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Withz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Python

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-02-09 12:04:06" itemprop="dateCreated datePublished" datetime="2020-02-09T12:04:06+08:00">2020-02-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-05-21 11:00:58" itemprop="dateModified" datetime="2020-05-21T11:00:58+08:00">2020-05-21</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/语言基础/" itemprop="url" rel="index"><span itemprop="name">语言基础</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="数字型"><a href="#数字型" class="headerlink" title="数字型"></a>数字型</h3><p>数字型包括：</p>
<ul>
<li>int：20</li>
<li>float：3.3</li>
<li>bool：True（True = 1, False = 0）</li>
<li>complex：4+2j, complex(4, 2)</li>
</ul>
<p>运算方式有：加(<code>+</code>)，减(<code>-</code>)，乘(<code>*</code>)，除-浮点(<code>/</code>)，除-整数(<code>//</code>)，取余(<code>%</code>)，乘方(<code>**</code>)</p>
<p>常用方法：</p>
<ul>
<li>range(n)：产生一个从0到n的序列。</li>
<li>range(m, n)：产生一个从m到n的序列。</li>
<li>sum()：对列表的所有元素求和</li>
<li>all()：判断列表中所有元素是否都是True</li>
<li>any()：判断列表中是否包含True</li>
</ul>
<p>运算方法：</p>
<ul>
<li>abs()</li>
<li>max()：参数可以为序列。</li>
<li>min()：参数可以为序列。</li>
<li>pow()：乘幂运算。</li>
<li>round()：四舍五入，可以指定小数点后的位数。</li>
<li>math.ceil()：向上取整。</li>
<li>math.floor()：向下取整。</li>
<li>math.exp()</li>
<li>math.fabs()</li>
<li>math.log()</li>
<li>math.log10()</li>
<li>math.modf()：返回小数部分和整数部分（元组，先小数，后整数）。</li>
<li>math.sqrt()</li>
<li>math.pi：内置常量，PI</li>
<li>math.e：内置常量，E</li>
</ul>
<p>随机函数：</p>
<ul>
<li>random.choice()：从给定的序列中随机选择一个元素。</li>
<li>random.randrange([start,] stop [, step])：在指定范围内按照基数底层的集合中获取一个随机数。基数默认为1。</li>
<li>random.random()：生成一个0到1之间的实数。</li>
<li>random.seed()：改变种子生成器。</li>
<li>random.shuffle()：将给定的序列随机排列。</li>
<li>random.uniform(x, y)：生成一个x到y之间的实数。</li>
</ul>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>可以使用<code>&#39;inline&#39;</code>、<code>&quot;inline&quot;</code>、<code>&#39;&#39;&#39;multi lines&#39;&#39;&#39;</code>方式。<br>可以使用转义字符。<br>索引从前面开始为<code>0</code>；从后面开始为<code>-1</code>。<br>字符串只读，不能修改某一个字符。</p>
<p>运算方式有（设<code>str_a=&quot;123456789&quot;</code>）：</p>
<ul>
<li>加(<code>str_a + str_b</code>)：字符串拼接。</li>
<li>乘(<code>str_a * 2</code>)：字符串重复。</li>
<li>切片(<code>str_a[0:-1]</code>, <code>str_a[3:]</code>)：返回字串”12345678”，”456789”，遵循左闭右开。</li>
<li>禁用转义字符(<code>r&#39;\n&#39;</code>)：返回”\n”，R作用一以。</li>
<li>in：查看是否在其中。</li>
<li>not in</li>
<li>%：格式字符串</li>
</ul>
<table>
<thead>
<tr>
<th>字符</th>
<th>描述</th>
<th>字符</th>
<th>描述</th>
<th>字符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\</code></td>
<td>续行</td>
<td><code>\\</code></td>
<td>反斜线</td>
<td><code>\&#39;</code></td>
<td>单引号</td>
</tr>
<tr>
<td><code>\&quot;</code></td>
<td>双引号</td>
<td><code>\a</code></td>
<td>响铃</td>
<td><code>\b</code></td>
<td>退格</td>
</tr>
<tr>
<td><code>\0</code></td>
<td>空</td>
<td><code>\n</code></td>
<td>换行</td>
<td><code>\v</code></td>
<td>纵向制表符</td>
</tr>
<tr>
<td><code>\r</code></td>
<td>回车</td>
<td><code>\f</code></td>
<td>换页</td>
<td><code>\t</code></td>
<td>横向制表符</td>
</tr>
<tr>
<td><code>\oYY</code></td>
<td>八进制</td>
<td><code>\xYY</code></td>
<td>十六进制</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h4><ul>
<li>join()：连接字符串</li>
<li>split()：分隔字符串，返回列表</li>
<li>count(s)：返回子串s出现次数</li>
<li>len()：返回字符串长度</li>
<li>strip()：去掉两边空格</li>
<li>find()：查找子串位置，未找到返回 -1</li>
<li>replace(old, new)：替换子串</li>
<li>bytes.decode(encoding=’UTF-8’,errors=’strict’)：解码为字符串</li>
<li>encode(encoding=’UTF-8’,errors=’strict’)：编码为二进制数据</li>
<li>ljust(width, fillchar)：左对齐，返回填充后的字符串</li>
<li>rstrip(width, fillchar)：右对齐，返回填充后的字符串</li>
<li>center(width, fillchar)：居中对齐，返回填充后的字符串</li>
</ul>
<h4 id="原始格式化字符串"><a href="#原始格式化字符串" class="headerlink" title="原始格式化字符串"></a>原始格式化字符串</h4><p>原始格式化字符串：</p>
<ul>
<li>%c：字符</li>
<li>%s：字符串</li>
<li>%d：整数</li>
<li>%u：无符号整数</li>
<li>%o：无符号八进制</li>
<li>%x：无符号十六进制</li>
<li>%X：无符号十六进制（大写）</li>
<li>%f：浮点，可以指定小数点后位数</li>
<li>%e：科学计数法</li>
<li>%E：科学计数法</li>
<li>%g：作用同%f%e</li>
<li>%G：作用同%f%E</li>
<li>%p：变量地址</li>
</ul>
<p>例如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"%s use python %f"</span> % (<span class="string">'User'</span>, <span class="number">3.7</span>)</span><br></pre></td></tr></table></figure></p>
<p>辅助指令：</p>
<ul>
<li><code>*</code>：定义宽度或小数点精度</li>
<li><code>-</code>：左对齐</li>
<li><code>+</code>：在正数前面显示加号</li>
<li><code>&lt;sp&gt;</code>：在正数前面显示空格</li>
<li><code>#</code>：在八进制数前面显示零(‘0’)，在十六进制前面显示’0x’或者’0X’(取决于用的是’x’还是’X’)</li>
<li><code>0</code>：显示的数字前面填充’0’而不是默认的空格</li>
<li><code>%</code>：’%%’输出一个单一的’%’</li>
<li><code>var</code>：映射变量(字典参数)</li>
<li><code>m.n.</code>：m 是显示的最小总宽度,n 是小数点后的位数</li>
</ul>
<p><a href="https://www.runoob.com/python3/python3-string.html" target="_blank" rel="noopener">参考</a></p>
<h4 id="增强型格式化字符串"><a href="#增强型格式化字符串" class="headerlink" title="增强型格式化字符串"></a>增强型格式化字符串</h4><p>增强型写法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定输出位置</span></span><br><span class="line"><span class="string">"&#123;1&#125; &#123;0&#125; &#123;1&#125;"</span>.format(<span class="string">"hello"</span>, <span class="string">"world"</span>)</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="string">'world hello world'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定输出</span></span><br><span class="line"><span class="string">"姓名：&#123;name&#125;, 年龄 &#123;age&#125;"</span>.format(name=<span class="string">"John"</span>, age=<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 输出列表</span></span><br><span class="line">my_list = [<span class="string">'First'</span>, <span class="string">'Second'</span>]</span><br><span class="line">print(<span class="string">"姓：&#123;0[0]&#125;, 名 &#123;0[1]&#125;"</span>.format(my_list))</span><br><span class="line"><span class="comment"># 格式化输出</span></span><br><span class="line"><span class="string">"&#123;:.2f&#125;"</span>.format(<span class="number">3.1415926</span>)  <span class="comment"># 输出 3.14</span></span><br><span class="line"><span class="comment"># 转义输出</span></span><br><span class="line"><span class="string">"&#123;&#123;&#125;&#125;"</span>.format()  <span class="comment"># 输出 &#123;&#125;</span></span><br></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th>格式</th>
<th>描述</th>
<th>格式</th>
<th>描述</th>
<th>格式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>{:.2f}</code></td>
<td>保留小数点后两位</td>
<td><code>{:+.2f}</code></td>
<td>带符号保留</td>
<td><code>{:.0f}</code></td>
<td>不带小数</td>
</tr>
<tr>
<td><code>{:0&gt;2d}</code></td>
<td>数字补零 (填充左边, 宽度为2)</td>
<td><code>{:x&lt;4d}</code></td>
<td>数字补x (填充右边, 宽度为4)</td>
<td><code>{:x&lt;4d}</code></td>
<td>数字补x (填充右边, 宽度为4)</td>
</tr>
<tr>
<td><code>{:,}</code></td>
<td>以逗号分隔</td>
<td><code>{:.2%}</code></td>
<td>百分比格式</td>
<td><code>{:.2e}</code></td>
<td>指数记法</td>
</tr>
<tr>
<td><code>{:&gt;10d}</code></td>
<td>右对齐</td>
<td><code>{:&lt;10d}</code></td>
<td>左对齐</td>
<td><code>{:^10d}</code></td>
<td>中间对齐</td>
</tr>
</tbody>
</table>
<p><a href="https://www.runoob.com/python/att-string-format.html" target="_blank" rel="noopener">参考</a></p>
<h4 id="f-string"><a href="#f-string" class="headerlink" title="f-string"></a>f-string</h4><p>Python 3.6 新增写法：字符串以<code>f</code>开头，字符串中的变量将会自动运算解析为结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">f'Hello <span class="subst">&#123;name&#125;</span>'</span></span><br><span class="line"><span class="string">f'<span class="subst">&#123;<span class="number">1</span>+<span class="number">2</span>&#125;</span>'</span></span><br><span class="line"><span class="string">f'<span class="subst">&#123;w[<span class="string">"name"</span>]&#125;</span>: <span class="subst">&#123;w[<span class="string">"age"</span>]&#125;</span>'</span></span><br></pre></td></tr></table></figure>
<p>f-string 使用<code>{content:format}</code>设置字符串格式。其中 content 是替换并填入字符串的内容，可以是变量、表达式或函数等，format 是格式描述符。</p>
<table>
<thead>
<tr>
<th>格式</th>
<th>描述</th>
<th>格式</th>
<th>描述</th>
<th>格式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;</code></td>
<td>左对齐</td>
<td><code>&gt;</code></td>
<td>右对齐</td>
<td><code>^</code></td>
<td>居中</td>
</tr>
<tr>
<td><code>+</code></td>
<td>加正负号</td>
<td><code>-</code></td>
<td>负数加负号</td>
<td><code>空格</code></td>
<td>正数加空格，负数加负号</td>
</tr>
<tr>
<td><code>#</code></td>
<td>进制数切换数字显示方式</td>
<td><code>width</code></td>
<td>指定数字宽度</td>
<td><code>0width</code></td>
<td>指定宽度并高位补0</td>
</tr>
<tr>
<td><code>width.precision</code></td>
<td>宽度.显示精度</td>
<td><code>,</code></td>
<td>千位分隔符</td>
<td><code>_</code></td>
<td>千位分隔符</td>
</tr>
<tr>
<td><code>b/c/d/o/x</code></td>
<td>进制显示方式</td>
<td><code>s</code></td>
<td>字符串</td>
<td><code>e/E/f/F/g/G/%</code></td>
<td>浮点数显示方式</td>
</tr>
<tr>
<td><code>%a/%A/%w/%u</code></td>
<td>星期</td>
<td><code>%d</code></td>
<td>日</td>
<td><code>%b/%B/%m</code></td>
<td>月</td>
</tr>
<tr>
<td><code>%y/%Y</code></td>
<td>年</td>
<td><code>%H/%I</code></td>
<td>小时</td>
<td><code>%p</code></td>
<td>上下午</td>
</tr>
<tr>
<td><code>%M/%S/%f</code></td>
<td>分钟，秒，微秒</td>
<td><code>%j</code></td>
<td>一年的第几天</td>
<td><code>%z</code></td>
<td>UTC偏移量</td>
</tr>
</tbody>
</table>
<p>例如</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">12345678</span></span><br><span class="line"><span class="string">f'c is <span class="subst">&#123;c:<span class="number">015</span>,d&#125;</span>'</span>   <span class="comment"># 'c is 000,012,345,678'</span></span><br><span class="line"></span><br><span class="line">e = datetime.datetime.today()</span><br><span class="line"><span class="string">f'the time is <span class="subst">&#123;e:%Y-%m-%d (%a) %H:%M:%S&#125;</span>'</span></span><br></pre></td></tr></table></figure>
<h4 id="Unicode-字符串"><a href="#Unicode-字符串" class="headerlink" title="Unicode 字符串"></a>Unicode 字符串</h4><p>在Python2中，普通字符串是以8位ASCII码进行存储的，而Unicode字符串则存储为16位unicode字符串，这样能够表示更多的字符集。使用的语法是在字符串前面加上前缀 u。</p>
<p>在Python3中，所有的字符串都是Unicode字符串。</p>
<h3 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h3><p>列表中的元素的类型可以不同。</p>
<p>运算方式有（设<code>list_a=[1, 2, &quot;a&quot;, True]</code>）：</p>
<ul>
<li>加(<code>list_a + list_b</code>)：列表拼接。</li>
<li>乘(<code>list_a * 2</code>)：列表重复。</li>
<li>切片(<code>list_a[0:-1]</code>, <code>list_a[3:]</code>)：返回列表<code>[1, 2, &quot;a&quot;]</code>，<code>[True]</code>。</li>
</ul>
<p>常用方法：</p>
<ul>
<li>count()：统计某元素出现次数</li>
<li>len()：返回元素个数</li>
<li>append()：在末尾添加元素</li>
<li>pop(n)：移除第n个元素，默认最后一个</li>
<li>index()：返回该元素的索引</li>
<li>insert()：插入一个元素</li>
<li>extend()：在末尾追加另一个列表的所有元素</li>
<li>remove()：移除第一个此元素</li>
<li>reverse()：翻转列表</li>
<li>sort()：元素排序</li>
<li>clear()：清空</li>
<li>copy()：复制</li>
<li>del list[x]：删除第x个元素</li>
</ul>
<p>内置函数：</p>
<ul>
<li><p>filter：过滤函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_odd</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> n % <span class="number">2</span> == <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">newlist = filter(is_odd, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>])</span><br><span class="line">print(newlist)  <span class="comment"># [1, 3, 5, 7, 9]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>map：映射函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line">map(square, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])  <span class="comment"># [1, 4, 9, 16, 25]</span></span><br><span class="line">map(<span class="keyword">lambda</span> x: x ** <span class="number">2</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])  <span class="comment"># 使用 lambda 匿名函数</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>reduce：累积函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y)</span> :</span>            <span class="comment"># 两数相加</span></span><br><span class="line">     <span class="keyword">return</span> x + y</span><br><span class="line"> </span><br><span class="line">reduce(add, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])   <span class="comment"># 计算列表和：1+2+3+4+5=15</span></span><br><span class="line">reduce(<span class="keyword">lambda</span> x, y: x+y, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])  <span class="comment"># 使用 lambda 匿名函数</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h3><p>元组的元素不可修改。<br>元组中的元素的类型可以不同。<br>如果元组包含了对象，那么对象是可以修改的。<br>构造空元组写作<code>tup1 = ()</code>，构造单元素元组<code>tup2 = (20,)</code>，注意有逗号。</p>
<p>运算方式有（设<code>tuple_a=(1, 2, &quot;a&quot;, True)</code>）：</p>
<ul>
<li>加(<code>tuple_a + tuple_b</code>)：元组拼接。</li>
<li>乘(<code>tuple_a * 2</code>)：元组重复。</li>
<li>切片(<code>tuple_a[0:-1]</code>, <code>tuple_a[3:]</code>)：返回元组<code>(1, 2, &quot;a&quot;)</code>，<code>(True)</code>。</li>
</ul>
<h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>集合中的元素类型必须一致。<br>集合中的元素不能重复。<br>创建一个空集合必须使用<code>set()</code>。</p>
<p>运算方式有：</p>
<ul>
<li>求差集(a - b)</li>
<li>求并集(a | b)</li>
<li>求交集(a &amp; b)</li>
<li>求二者中不同时拥有的元素(a ^ b)</li>
</ul>
<p>常用操作：</p>
<ul>
<li>add()：添加元素</li>
<li>update()：批量添加元素</li>
<li>remove()：移除元素，如果不存在，会报错</li>
<li>discard()：移除元素，如果不存在，不会报错</li>
<li>pop()：随机删除一个</li>
<li>len()：求元素个数</li>
<li>clear()：情况集合</li>
<li>x in s：判断使用包含元素</li>
</ul>
<h3 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h3><p>字典中的元素按照键值对存取。<br>字典中<code>Key</code>必须是不可变的数据类型（字符串，元组，常量）。<br>字典中<code>Key</code>值必须是唯一的。</p>
<p>常用操作：</p>
<ul>
<li>clear()：清空字典</li>
<li>copy()：浅拷贝</li>
<li>get()：返回某键的值，否则返回default值</li>
<li>key in dict：判断是否有该key</li>
<li>pop()：删除某个key</li>
</ul>
<h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><p>int()：转换为整型，可以接受：字符串，Bytes对象，数字。<br>float()：转换为浮点，可以接受：字符串，数字。<br>str()：转换为字符串，可接受几乎所有对象，转换结果适用于人类阅读。<br>repr()：转换为字符串，可接受几乎所有对象，转换结果适用于机器使用。<br>eval()：将字符串作为Python语句执行，返回执行结果。<br>tuple()：转化为元组，可以接受：列表，字符串等。<br>list()：转化为列表，可以接受：元组，字符串等。<br>set()：转化为集合。<br>dict()：转化为字典，可以接受：(key, value)的序列。<br>chr()：整数转化为字符。<br>ord()：字符转整数。<br>unichr()：整数转换为Unicode字符。<br>hex()：整数转十六进制字符串。<br>oct()：整数转八进制字符串。</p>
<p>chr()：将数字按照ASCII转化为字符<br>ord()：转换ASCII字符为整数<br>bytearray()：返回一个Byte数组，参数是整数n，则初始化数组长度为n；如果是字符串，则将字符串转换为Bytes<br>compile(source, filename, mode)：将字符串编译为字节码，mode可以为exec、eval、single</p>
<h3 id="类型注解"><a href="#类型注解" class="headerlink" title="类型注解"></a>类型注解</h3><p>在Python中，我们创建变量，传递变量是不需要注明类型的。但是这也造成了不便。因此 Python 3 提供了类型注解的功能，来表明变量类型。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># x:int 注明x是一个int型变量，-&gt; 指明了返回值类型为int</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x:int, y:int)</span> -&gt; int:</span></span><br><span class="line">    <span class="comment"># 声明一个int行变量，并赋值</span></span><br><span class="line">    z:int = <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>
<h3 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h3><p>input()：标准输入<br>print()：标准输出<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出的结尾：以逗号结尾，默认是以换行结尾</span></span><br><span class="line">print(end=<span class="string">','</span>)</span><br><span class="line"><span class="comment"># 输出对象间隔号：以逗号间隔，默认是空格</span></span><br><span class="line">print(sep=<span class="string">','</span>)</span><br><span class="line"><span class="comment"># 输出到文件</span></span><br><span class="line">print(file=<span class="string">''</span>)</span><br><span class="line"><span class="comment"># 是否强制刷新流</span></span><br><span class="line">print(flush=<span class="string">','</span>)</span><br></pre></td></tr></table></figure></p>
<p>exec()：执行Python语句，无返回值<br>eval()：将给定表达式用Python执行，并返回执行结果<br>execfile(filename)：执行一个文件，返回执行结果<br>file()：创建一个FILE对象，同open()<br>memoryview()：查看对象的在内存的存储形式，对使用缓冲区的地方非常友好，尤其是对str与bytearray<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">'aaaaaa'</span></span><br><span class="line">ma = memoryview(a)</span><br><span class="line">ma.readonly  <span class="comment"># True，只读的memoryview</span></span><br><span class="line">mb = ma[:<span class="number">2</span>]  <span class="comment"># 不会产生新的字符串</span></span><br><span class="line"></span><br><span class="line">a = bytearray(<span class="string">'aaaaaa'</span>)</span><br><span class="line">ma = memoryview(a)</span><br><span class="line">ma.readonly      <span class="comment"># False，可写的memoryview</span></span><br><span class="line">mb = ma[:<span class="number">2</span>]      <span class="comment"># 不会会产生新的bytearray</span></span><br><span class="line">mb[:<span class="number">2</span>] = <span class="string">'bb'</span>    <span class="comment"># 对mb的改动就是对ma的改动</span></span><br><span class="line">mb.tobytes()     <span class="comment"># 'bb' </span></span><br><span class="line">ma.tobytes()     <span class="comment"># 'bbaaaa'</span></span><br></pre></td></tr></table></figure></p>
<p>globals()：返回当前位置的全局变量，字典形式<br>locals()：返回当前位置的局部变量，字典形式</p>
<p>id()：获取对象的内存地址<br>hash()：返回对象的哈希值<br>super()：调用父类<br>vars()：将对象转化为字典</p>
<p>reload()：重新加载模块<br><code>__import__</code>()：动态加载类或模块<br>help()：查看模块或函数的帮助信息</p>
<h3 id="查看类型"><a href="#查看类型" class="headerlink" title="查看类型"></a>查看类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type(x)  <span class="comment"># 查看变量的类型，子类与父类不一致。</span></span><br><span class="line">isinstance(x, int)  <span class="comment"># 查看变量是否是某种类型，子类和父类被认为一直。</span></span><br><span class="line">issubclass(father, son)  <span class="comment"># 判断是否为子类</span></span><br></pre></td></tr></table></figure>
<h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 遍历列表</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> x_list:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># 遍历字符串</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">"abcdefg"</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># 带索引遍历</span></span><br><span class="line"><span class="keyword">for</span> i, name <span class="keyword">in</span> enumerate(name_list, start_index):</span><br><span class="line">    print(<span class="string">f'index is <span class="subst">&#123;i&#125;</span>,name is <span class="subst">&#123;name&#125;</span>'</span>)</span><br><span class="line"><span class="comment"># 打包成元组遍历 a = [1,2,3], c = [4,5,6,7,8], zip(a,c) --&gt; [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> zip(albums, years):</span><br><span class="line">    print(i)</span><br><span class="line"><span class="comment"># 单行 for 循环</span></span><br><span class="line">s.split() <span class="keyword">for</span> s <span class="keyword">in</span> sentence</span><br><span class="line"><span class="comment"># 相当于</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> sentence:</span><br><span class="line">    s.split()</span><br><span class="line"><span class="comment"># 遍历字典</span></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> knights.items():</span><br><span class="line">    print(k, v)</span><br><span class="line"><span class="comment"># 遍历排序后的集合</span></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> sorted(set(basket)):</span><br><span class="line">    print(f)</span><br></pre></td></tr></table></figure>
<h3 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">list=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">it = iter(list)    <span class="comment"># 创建迭代器对象</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> it:</span><br><span class="line">    <span class="keyword">print</span> (x, end=<span class="string">" "</span>)</span><br><span class="line">it = iter(list)    <span class="comment"># 创建迭代器对象</span></span><br><span class="line"><span class="keyword">print</span> (next(it))   <span class="comment"># 输出迭代器的下一个元素</span></span><br><span class="line"><span class="keyword">print</span> (next(it))   <span class="comment"># 输出迭代器的下一个元素</span></span><br></pre></td></tr></table></figure>
<p>StopIteration 异常用于标识迭代的完成，防止出现无限循环的情况，在 <code>__next__()</code> 方法中我们可以设置在完成指定循环次数后触发 StopIteration 异常来结束迭代。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNumbers</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.a = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> self</span><br><span class="line"> </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__next__</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> self.a &lt;= <span class="number">20</span>:</span><br><span class="line">      x = self.a</span><br><span class="line">      self.a += <span class="number">1</span></span><br><span class="line">      <span class="keyword">return</span> x</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">raise</span> StopIteration</span><br><span class="line"> </span><br><span class="line">myclass = MyNumbers()</span><br><span class="line">myiter = iter(myclass)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> myiter:</span><br><span class="line">  print(x)</span><br></pre></td></tr></table></figure>
<p>在 Python 中，使用了 yield 的函数被称为生成器。</p>
<p>跟普通函数不同的是，生成器是一个返回迭代器的函数，只能用于迭代操作，更简单点理解生成器就是一个迭代器。</p>
<p>在调用生成器运行的过程中，每次遇到 yield 时函数会暂停并保存当前所有的运行信息，返回 yield 的值, 并在下一次执行 next() 方法时从当前位置继续运行。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fibonacci</span><span class="params">(n)</span>:</span> <span class="comment"># 生成器函数 - 斐波那契</span></span><br><span class="line">    a, b, counter = <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> (counter &gt; n): </span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">yield</span> a</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        counter += <span class="number">1</span></span><br><span class="line">f = fibonacci(<span class="number">10</span>) <span class="comment"># f 是一个迭代器，由生成器返回生成</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">print</span> (next(f), end=<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">except</span> StopIteration:</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure>
<h3 id="不定长传参"><a href="#不定长传参" class="headerlink" title="不定长传参"></a>不定长传参</h3><p>转为元组传入 <code>*</code><br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printinfo</span><span class="params">( arg1, *vartuple )</span>:</span></span><br></pre></td></tr></table></figure></p>
<p>转为字典传入 <code>**</code><br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printinfo</span><span class="params">( arg1, **var_args_dict )</span>:</span></span><br></pre></td></tr></table></figure></p>
<h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum = <span class="keyword">lambda</span> arg1, arg2: arg1 + arg2</span><br></pre></td></tr></table></figure>
<h3 id="强制位置参数"><a href="#强制位置参数" class="headerlink" title="强制位置参数"></a>强制位置参数</h3><p><code>/</code>前面的参数不能使用关键字参数。<br><code>*</code>后面的参数必须使用关键字参数。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(a, b, /, c, d, *, e, f)</span>:</span></span><br><span class="line">    print(a, b, c, d, e, f)</span><br></pre></td></tr></table></figure>
<h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h3><h4 id="堆栈"><a href="#堆栈" class="headerlink" title="堆栈"></a>堆栈</h4><p>可以使用列表作为堆栈。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stack = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">stack.append(<span class="number">4</span>)</span><br><span class="line">x = stack.pop()</span><br></pre></td></tr></table></figure>
<p>可以使用模块。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> LifoQueue</span><br><span class="line">stack = LifoQueue()</span><br><span class="line">stack.put(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> stack.empty():</span><br><span class="line">    x = stack.get()</span><br></pre></td></tr></table></figure>
<h4 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h4><p>使用列表作为队列，但是效率不高。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">que = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">que.append(<span class="number">4</span>)</span><br><span class="line">x = stack.popleft()</span><br></pre></td></tr></table></figure>
<p>可以使用模块。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line">que = Queue()</span><br><span class="line">q.put(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> q.empty():</span><br><span class="line">    x = q.get()</span><br></pre></td></tr></table></figure>
<h4 id="优先队列"><a href="#优先队列" class="headerlink" title="优先队列"></a>优先队列</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> PriorityQueue</span><br><span class="line">q = PriorityQueue()</span><br><span class="line">q.put(Task(<span class="number">5</span>, <span class="string">'Mid-level job'</span>))</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> q.empty():</span><br><span class="line">    next_job = q.get()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, priority, description)</span>:</span></span><br><span class="line">        self.priority = priority</span><br><span class="line">        self.description = description</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 运算符重载</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.priority &lt; other.priority</span><br></pre></td></tr></table></figure>
<h4 id="列表推导式"><a href="#列表推导式" class="headerlink" title="列表推导式"></a>列表推导式</h4><p>可以方便用于创建列表</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vec1 = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line">vec2 = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">-9</span>]</span><br><span class="line">[<span class="number">3</span>*x <span class="keyword">for</span> x <span class="keyword">in</span> vec1]                <span class="comment"># [6, 12, 18]</span></span><br><span class="line">[x*y <span class="keyword">for</span> x <span class="keyword">in</span> vec1 <span class="keyword">for</span> y <span class="keyword">in</span> vec2]  <span class="comment"># [8, 6, -18, 16, 12, -36, 24, 18, -54]</span></span><br></pre></td></tr></table></figure>
<h3 id="模块与包"><a href="#模块与包" class="headerlink" title="模块与包"></a>模块与包</h3><p><code>__name__</code>属性来使该程序块仅在该模块自身运行时执行。</p>
<p>dir() 函数可以找到模块内定义的所有名称。以一个字符串列表的形式返回：</p>
<p>包：管理 Python 模块命名空间的形式，如sound包下的effects包下的echo模块，使用方法：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sound.effects.echo</span><br></pre></td></tr></table></figure>
<p>对应的目录结构为：</p>
<ul>
<li>sound/<ul>
<li><code>__init__.py</code></li>
<li>effects/<ul>
<li><code>__init__.py</code></li>
<li>echo.py</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>包的下面必须有<code>__init__.py</code>文件（可以是空文件），否则将不会识别为包。</p>
<p>如果包定义文件 <code>__init__.py</code> 存在一个叫做 <code>__all__</code> 的列表变量，那么在使用 from package import * 的时候就把这个列表中的所有名字作为包内容导入。</p>
<h3 id="读写文件"><a href="#读写文件" class="headerlink" title="读写文件"></a>读写文件</h3><p>使用<code>open()</code>可以打开文件，其完整的参数表为：</p>
<ul>
<li>file: 必需，文件路径（相对或者绝对路径）。</li>
<li>mode: 可选，文件打开模式</li>
<li>buffering: 设置缓冲</li>
<li>encoding: 一般使用utf8</li>
<li>errors: 报错级别</li>
<li>newline: 区分换行符</li>
<li>closefd: 传入的file参数类型</li>
<li>opener:</li>
</ul>
<p>mode指定了文件打开模式，默认为只读，常见方式有：</p>
<table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
<th>模式</th>
<th>描述</th>
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>写模式，文件已存在则报错</td>
<td>b</td>
<td>二进制</td>
<td>+</td>
<td>读写</td>
</tr>
<tr>
<td>r</td>
<td>只读</td>
<td>rb</td>
<td>只读，二进制</td>
<td>r+</td>
<td>读写</td>
</tr>
<tr>
<td>rb+</td>
<td>读写，二进制</td>
<td>w</td>
<td>只写</td>
<td>wb</td>
<td>只写，二进制</td>
</tr>
<tr>
<td>w+</td>
<td>读写</td>
<td>wb+</td>
<td>读写，二进制</td>
<td>a</td>
<td>追加写</td>
</tr>
<tr>
<td>ab</td>
<td>追加写，二进制</td>
<td>a+</td>
<td>追加读写</td>
<td>ab+</td>
<td>追加读写，二进制</td>
</tr>
</tbody>
</table>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">f = open(filename)</span><br><span class="line"><span class="comment"># 读取n个字符或字节，默认是全部内容</span></span><br><span class="line">f.read(n)</span><br><span class="line"><span class="comment"># 读取一行，如果为空，说明已经最后一行了</span></span><br><span class="line">f.readline()</span><br><span class="line"><span class="comment"># 读取所有行</span></span><br><span class="line">f.readlines()</span><br><span class="line"><span class="comment"># 写入</span></span><br><span class="line">f.write(data)</span><br><span class="line"><span class="comment"># 返回当前指针位置</span></span><br><span class="line">f.tell()</span><br><span class="line"><span class="comment"># 移动指针位置：0 从开头向后移动m个字节，1 从当前位置向后移动m个字节，2 从结尾向后移动m个字节</span></span><br><span class="line">f.seek(m, <span class="number">0</span>)</span><br><span class="line"><span class="comment"># 获取文件描述符</span></span><br><span class="line">f.fileno()</span><br><span class="line"><span class="comment"># 判断是否为终端设备</span></span><br><span class="line">f.isatty()</span><br><span class="line"><span class="comment"># 刷新缓冲区到文件</span></span><br><span class="line">f.flush()</span><br><span class="line"><span class="comment"># 关闭文件，释放资源</span></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>如果觉得打开文件再关闭文件操作繁琐，Python还提供了<code>with as</code>功能，可以打开后不管释放：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行完毕自动释放</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"/tmp/file.txt"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = file.read()</span><br></pre></td></tr></table></figure>
<p>with语句不仅可以用来操作文件，线程等资源也可以使用。</p>
<p>pickle模块，可以用来序列化和反序列化对象。利用这个模块，我们可以用来保存数据结构到文件中。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">pickle.dump(obj, file)</span><br><span class="line">x = pickle.load(file)</span><br></pre></td></tr></table></figure>
<h3 id="OS-模块"><a href="#OS-模块" class="headerlink" title="OS 模块"></a>OS 模块</h3><p>目录与权限：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检验权限模式，尝试使用UserID，GroupID访问目录，检验是否有权限访问。mode：</span></span><br><span class="line"><span class="comment"># os.F_OK 测试path是否存在。</span></span><br><span class="line"><span class="comment"># os.R_OK 测试path是否可读。</span></span><br><span class="line"><span class="comment"># os.W_OK 测试path是否可写。</span></span><br><span class="line"><span class="comment"># os.X_OK 测试path是否可执行。</span></span><br><span class="line">os.access(path, mode)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改当前进程的看到的根目录</span></span><br><span class="line"><span class="comment"># 例如 os.chroot('/tmp')</span></span><br><span class="line"><span class="comment"># 则 对于进程'/'目录就是系统的'/tmp'目录</span></span><br><span class="line">os.chroot(path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换工作目录</span></span><br><span class="line">os.chdir(path)</span><br><span class="line"><span class="comment"># 获取工作目录</span></span><br><span class="line">os.getcwd()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改权限</span></span><br><span class="line">os.chmod(path, mode)</span><br><span class="line"><span class="comment"># 更改文件所有者</span></span><br><span class="line">os.chown(path, uid, gid)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取路劲下的文件和文件夹</span></span><br><span class="line">os.listdir(path)</span><br><span class="line"><span class="comment"># 创建路径，mode为权限 0o755</span></span><br><span class="line">os.makedirs(path[, mode])</span><br><span class="line"><span class="comment"># 删除路径为path的文件</span></span><br><span class="line">os.remove(path)</span><br><span class="line"><span class="comment"># 删除空目录，如果非空则异常</span></span><br><span class="line">os.rmdir(path)</span><br><span class="line"><span class="comment"># 重命名</span></span><br><span class="line">os.rename(src, dst)</span><br><span class="line"><span class="comment"># 获取path信息</span></span><br><span class="line">os.stat(path)</span><br><span class="line"><span class="comment"># 获取文件系统信息</span></span><br><span class="line">os.statvfs(path)</span><br></pre></td></tr></table></figure>
<p>文件：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取文件描述符</span></span><br><span class="line">fx = f.fileno()</span><br><span class="line">fx = os.open(filepath, os.O_RDONLY)</span><br><span class="line"><span class="comment"># 关闭文件</span></span><br><span class="line">os.close(fx)</span><br><span class="line"><span class="comment"># 关闭所有文件，左闭右开</span></span><br><span class="line">os.closerange(fx, fy)</span><br><span class="line"><span class="comment"># 复制文件描述符</span></span><br><span class="line">os.dup(fx)</span><br><span class="line"><span class="comment"># 通过描述符改变工作目录，fx指向目录</span></span><br><span class="line">os.fchdir(fx)</span><br><span class="line"><span class="comment"># 修改文件所有权</span></span><br><span class="line">os.fchown(fx, uid, gid)</span><br><span class="line"><span class="comment"># 强制写入磁盘</span></span><br><span class="line">os.fdatasync(fx)</span><br><span class="line"><span class="comment"># 打开的文件的系统配置信息，name，'PC_LINK_MAX' 文件最大连接数，'PC_NAME_MAX' 文件名最长长度</span></span><br><span class="line">os.fpathconf(fx, name)</span><br><span class="line"><span class="comment"># 获取描述符状态，包括设备信息，文件修改时间，用户ID等</span></span><br><span class="line">os.fstat(fx)</span><br><span class="line"><span class="comment"># 获取描述符状态，包括文件系统块大小，可用块数，文件结点总数</span></span><br><span class="line">os.fstatvfs(fx) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建命名管道，mode为权限 默认0o666</span></span><br><span class="line">os.mkfifo(path[, mode])</span><br><span class="line"><span class="comment"># 打开一个终端</span></span><br><span class="line">os.openpty()</span><br><span class="line"><span class="comment"># 创建一个管道</span></span><br><span class="line">os.pipe()</span><br><span class="line"><span class="comment"># 从command打开一个管道，command 使用的命令，mode r默认 w，bufsize 0无缓冲 1有缓冲</span></span><br><span class="line">os.popen(command[, mode[, bufsize]])</span><br></pre></td></tr></table></figure></p>
<p>os.path 模块<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绝对路径</span></span><br><span class="line">os.path.abspath(path)</span><br><span class="line"><span class="comment"># 文件名</span></span><br><span class="line">os.path.basename(path)</span><br><span class="line"><span class="comment"># 文件路径</span></span><br><span class="line">os.path.dirname(path)</span><br><span class="line"><span class="comment"># 路径是否存在</span></span><br><span class="line">os.path.exists(path)</span><br><span class="line"><span class="comment"># 文件访问时间</span></span><br><span class="line">os.path.getatime(path)</span><br><span class="line"><span class="comment"># 文件修改时间</span></span><br><span class="line">os.path.getmtime(path)</span><br><span class="line"><span class="comment"># 路径创建时间</span></span><br><span class="line">os.path.getctime(path)</span><br><span class="line"><span class="comment"># 文件大小</span></span><br><span class="line">os.path.getsize(path)</span><br><span class="line"><span class="comment"># 是否为绝对路径</span></span><br><span class="line">os.path.isabs(path)</span><br><span class="line"><span class="comment"># 是否为文件</span></span><br><span class="line">os.path.isfile(path)</span><br><span class="line"><span class="comment"># 是否为目录</span></span><br><span class="line">os.path.isdir(path)</span><br><span class="line"><span class="comment"># 是否为链接</span></span><br><span class="line">os.path.islink(path)</span><br><span class="line"><span class="comment"># 是否为挂载点</span></span><br><span class="line">os.path.ismount(path)</span><br><span class="line"><span class="comment"># 合并目录与文件名</span></span><br><span class="line">os.path.join(path1[, path2[, ...]])</span><br><span class="line"><span class="comment"># 转换path大小写与斜杠</span></span><br><span class="line">os.path.normcase(path)</span><br><span class="line"><span class="comment"># 规范path形式</span></span><br><span class="line">os.path.normpath(path)</span><br><span class="line"><span class="comment"># 返回path真实路径</span></span><br><span class="line">os.path.realpath(path)</span><br><span class="line"><span class="comment"># 判断目录，文件是否相同</span></span><br><span class="line">os.path.samefile(path1, path2)</span><br><span class="line"><span class="comment"># 判断是否指向同一文件</span></span><br><span class="line">os.path.sameopenfile(fp1, fp2)</span><br><span class="line"><span class="comment"># 分割路径与文件名 元组</span></span><br><span class="line">os.path.split(path)</span><br><span class="line"><span class="comment"># 返回驱动器名和路径 windows下 元组</span></span><br><span class="line">os.path.splitdrive(path)</span><br><span class="line"><span class="comment"># 分割路径，返回路径名 扩展名 元组</span></span><br><span class="line">os.path.splitext(path)</span><br><span class="line"><span class="comment"># 分割为加载点与文件</span></span><br><span class="line">os.path.splitunc(path)</span><br><span class="line"><span class="comment"># 遍历path，每个目录都调用visit函数 visit(arg, dirname 目录, names 目录下所有文件名)</span></span><br><span class="line">os.path.walk(path, visit, arg)</span><br></pre></td></tr></table></figure></p>
<h3 id="异常与断言"><a href="#异常与断言" class="headerlink" title="异常与断言"></a>异常与断言</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># except 后可加元组，可以包含多个Exception</span></span><br><span class="line"><span class="keyword">except</span> (ZeroDivisionError, KeyboardInterrupt):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># finally不论发生异常与否都会执行，如果异常未被接住，则会在finally执行完毕后抛出</span></span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>Python assert（断言）用于判断一个表达式，在表达式条件为 False 的时候触发异常。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法 assert expression[, arguments] </span></span><br><span class="line"><span class="comment"># 例如</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">3</span> + <span class="number">2</span> == <span class="number">5</span>, <span class="string">'结果不为 5'</span></span><br><span class="line"><span class="comment"># 输出 AssertionError: 结果不为 5</span></span><br></pre></td></tr></table></figure>
<h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><p>类的属性与方法的访问权限：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认为公有</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 保护 一个下划线</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_fun</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 私有 两个下划线</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__fun</span><span class="params">()</span>:</span></span><br></pre></td></tr></table></figure></p>
<p>类的专用方法有：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 析构函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__del__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 打印</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 按索引赋值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__setitem__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 按索引取值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 获取长度</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__len__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 比较</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__cmp__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 调用</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 运算符重载</span></span><br><span class="line"><span class="comment"># 加</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 减</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__sub__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 乘</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__mul__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 除</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__truediv__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 取余</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__mod__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 乘方</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__pow__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 小于</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__lt__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 等于</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 大于</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__gt__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 小于等于</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__le__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 不等于</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__ne__</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment"># 大于等于</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__ge__</span><span class="params">()</span>:</span></span><br></pre></td></tr></table></figure></p>
<p>在类的继承中，子类不重写 <code>__init__</code>，实例化子类时，会自动调用父类定义的 <code>__init__</code>。子类重写 <code>__init__</code>，就不会调用父类的初始化函数。如果都想执行，可以使用super()调用。</p>
<h3 id="标准库"><a href="#标准库" class="headerlink" title="标准库"></a>标准库</h3><h4 id="shutil"><a href="#shutil" class="headerlink" title="shutil"></a>shutil</h4><p>shutil模块提供了针对日常的文件和目录管理任务：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line">shutil.copyfile(<span class="string">'a.txt'</span>,<span class="string">'b.txt'</span>)</span><br><span class="line">shutil.move(<span class="string">'/dir_a/a.txt'</span>,<span class="string">'/dir_b'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="blog"><a href="#blog" class="headerlink" title="blog"></a>blog</h4><p>glob模块提供了一个函数用于从目录通配符搜索中生成文件列表</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">glob.glob(<span class="string">'*.py'</span>)  <span class="comment"># ['primes.py', 'random.py', 'quote.py']</span></span><br></pre></td></tr></table></figure>
<h4 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h4><p>sys可以读取命令行参数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">print(sys.argv)  <span class="comment"># ['demo.py', 'arg1', 'arg2', 'arg3']</span></span><br></pre></td></tr></table></figure>
<p>也可以重定向输出，如stdin，stdout，stderr</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sys.stderr.write(<span class="string">'Warning, log file not found starting a new one\n'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="re"><a href="#re" class="headerlink" title="re"></a>re</h4><p>re模块为高级字符串处理提供了正则表达式工具。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">re.findall(<span class="string">r'\bf[a-z]*'</span>, <span class="string">'which foot or hand fell fastest'</span>)</span><br><span class="line"><span class="comment"># ['foot', 'fell', 'fastest']</span></span><br><span class="line">re.sub(<span class="string">r'(\b[a-z]+) \1'</span>, <span class="string">r'\1'</span>, <span class="string">'cat in the the hat'</span>)</span><br><span class="line"><span class="comment"># 'cat in the hat'</span></span><br></pre></td></tr></table></figure>
<h4 id="datetime"><a href="#datetime" class="headerlink" title="datetime"></a>datetime</h4><p>datetime模块为日期和时间处理同时提供了简单和复杂的方法。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date, time, datetime</span><br><span class="line"><span class="comment"># 格式化输出</span></span><br><span class="line">now = date.today()</span><br><span class="line">now.strftime(<span class="string">"%m-%d-%y. %d %b %Y is a %A on the %d day of %B."</span>)</span><br><span class="line"><span class="comment"># '12-02-03. 02 Dec 2003 is a Tuesday on the 02 day of December.'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 日期天数差 </span></span><br><span class="line">birthday = date(<span class="number">1964</span>, <span class="number">7</span>, <span class="number">31</span>)</span><br><span class="line">age = now - birthday</span><br><span class="line">age.days  <span class="comment"># 14368</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前时间戳</span></span><br><span class="line">time_stamp = time.time()</span><br><span class="line"><span class="comment"># 转为日期时间</span></span><br><span class="line">datetime.fromtimestamp(time_stamp)</span><br><span class="line"><span class="comment"># 转为时间戳</span></span><br><span class="line">int(time.mktime(today.timetuple()))</span><br><span class="line"><span class="comment"># 补时差 </span></span><br><span class="line">today + datetime.timedelta(hours=<span class="number">8</span>)</span><br></pre></td></tr></table></figure>
<h4 id="数据压缩"><a href="#数据压缩" class="headerlink" title="数据压缩"></a>数据压缩</h4><p>以下模块直接支持通用的数据打包和压缩格式：zlib，gzip，bz2，zipfile，以及 tarfile。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line">s = <span class="string">b'witch which has which witches wrist watch'</span></span><br><span class="line">len(s)  <span class="comment"># 41</span></span><br><span class="line">t = zlib.compress(s)</span><br><span class="line">len(t)  <span class="comment"># 37</span></span><br><span class="line">zlib.decompress(t)  <span class="comment"># b'witch which has which witches wrist watch'</span></span><br><span class="line">zlib.crc32(s)  <span class="comment"># 226805979</span></span><br></pre></td></tr></table></figure>
<h4 id="计时器"><a href="#计时器" class="headerlink" title="计时器"></a>计时器</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> timeit <span class="keyword">import</span> Timer</span><br><span class="line">Timer(<span class="string">'t=a; a=b; b=t'</span>, <span class="string">'a=1; b=2'</span>).timeit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试函数调用时间</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    L = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        L.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">import</span> timeit</span><br><span class="line">    print(timeit.timeit(<span class="string">"test()"</span>, setup=<span class="string">"from __main__ import test"</span>))</span><br></pre></td></tr></table></figure>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><p>doctest模块提供了一个工具，扫描模块并根据程序中内嵌的文档字符串执行测试。<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">average</span><span class="params">(values)</span>:</span></span><br><span class="line">    <span class="string">"""Computes the arithmetic mean of a list of numbers.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print(average([20, 30, 70]))</span></span><br><span class="line"><span class="string">    40.0</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">return</span> sum(values) / len(values)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> doctest</span><br><span class="line">doctest.testmod()   <span class="comment"># 根据所给注释，自动验证本文档所有函数</span></span><br></pre></td></tr></table></figure></p>
<p>unittest模块可以在一个独立的文件里提供一个更全面的测试集。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestStatisticalFunctions</span><span class="params">(unittest.TestCase)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_average</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.assertEqual(average([<span class="number">20</span>, <span class="number">30</span>, <span class="number">70</span>]), <span class="number">40.0</span>)</span><br><span class="line">        self.assertEqual(round(average([<span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>]), <span class="number">1</span>), <span class="number">4.3</span>)</span><br><span class="line">        self.assertRaises(ZeroDivisionError, average, [])</span><br><span class="line">        self.assertRaises(TypeError, average, <span class="number">20</span>, <span class="number">30</span>, <span class="number">70</span>)</span><br><span class="line"></span><br><span class="line">unittest.main()  <span class="comment"># 从命令行调用，执行所有测试</span></span><br></pre></td></tr></table></figure>
<h2 id="进阶内容"><a href="#进阶内容" class="headerlink" title="进阶内容"></a>进阶内容</h2><h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
<th>模式</th>
<th>描述</th>
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>^</code></td>
<td>开头</td>
<td><code>$</code></td>
<td>末尾</td>
<td><code>.</code></td>
<td>任意字符，除了换行符</td>
</tr>
<tr>
<td><code>[...]</code></td>
<td>一组字符</td>
<td><code>[^...]</code></td>
<td>不在<code>[]</code>中的字符</td>
<td><code>re*</code></td>
<td>匹配0个或多个的表达式</td>
</tr>
<tr>
<td><code>re+</code></td>
<td>匹配1个或多个的表达式</td>
<td><code>re?</code></td>
<td>匹配0个或1个表达式片段</td>
<td><code>re{n}</code></td>
<td>匹配n个前面表达式片段</td>
</tr>
<tr>
<td><code>re{n,}</code></td>
<td>精确匹配n个前面表达式片段</td>
<td><code>re{n,m}</code></td>
<td>匹配 n 到 m 次由前面的正则表达式片段</td>
<td>`a</td>
<td>b`</td>
<td>匹配a或b</td>
</tr>
<tr>
<td><code>(re)</code></td>
<td>匹配括号内的表达式</td>
<td><code>(?#...)</code></td>
<td>注释</td>
</tr>
<tr>
<td><code>\w</code></td>
<td>数字字母下划线</td>
<td><code>\W</code></td>
<td>非数字字母下划线</td>
</tr>
<tr>
<td><code>\s</code></td>
<td>任意空白字符</td>
<td><code>\S</code></td>
<td>任意非空字符</td>
<td><code>\d</code></td>
<td>任意数字</td>
</tr>
<tr>
<td><code>\D</code></td>
<td>任意非数字</td>
<td><code>\A</code></td>
<td>字符串开始</td>
<td><code>\Z</code></td>
<td>字符串结束或换行前</td>
</tr>
<tr>
<td><code>\z</code></td>
<td>字符串结束</td>
<td><code>\G</code></td>
<td>最后匹配完成的位置</td>
<td><code>\b</code></td>
<td>单词边界</td>
</tr>
<tr>
<td><code>\B</code></td>
<td>非单词边界</td>
<td><code>\n</code>,<code>\t</code></td>
<td>换行符，制表符</td>
<td><code>\1</code>,…,<code>\9</code></td>
<td>匹配第n个分组的内容</td>
</tr>
</tbody>
</table>
<p>re.match 尝试从字符串的起始位置匹配一个模式，如果不是起始位置匹配成功的话，match()就返回none。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pattern 正则表达式</span></span><br><span class="line"><span class="comment"># string 要匹配的字符串</span></span><br><span class="line"><span class="comment"># flag 标志位</span></span><br><span class="line"><span class="comment"># 未匹配返回None</span></span><br><span class="line">print(re.match(<span class="string">'a'</span>, <span class="string">'a.b.c'</span>).span())  <span class="comment"># span 返回匹配开始与结束的位置 返回(0, 1)</span></span><br><span class="line">print(re.match(<span class="string">'c'</span>, <span class="string">'a.b.c'</span>)) <span class="comment"># 返回 None</span></span><br><span class="line"></span><br><span class="line">obj = re.match(pattern, string, flags=<span class="number">0</span>)</span><br><span class="line">obj.group()  <span class="comment"># 原始对象</span></span><br><span class="line">obj.group(<span class="number">1</span>) <span class="comment"># 获取匹配的值</span></span><br><span class="line">obj.group(<span class="number">2</span>) <span class="comment"># 获取匹配的值</span></span><br></pre></td></tr></table></figure>
<p>re.search 扫描整个字符串并返回第一个成功的匹配。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.search(pattern, string, flags=<span class="number">0</span>).span() <span class="comment"># 返回匹配的位置</span></span><br></pre></td></tr></table></figure>
<p>re.sub用于替换字符串中的匹配项</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># repl 替换的字符串，也可以是函数</span></span><br><span class="line"><span class="comment"># count 最大替换次数</span></span><br><span class="line"><span class="comment"># 返回 替换次数</span></span><br><span class="line">re.sub(pattern, repl, string, count=<span class="number">0</span>, flags=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>compile 函数用于编译正则表达式，生成一个正则表达式（ Pattern ）对象，供 match() 和 search() 这两个函数使用。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pt = re.compile(pattern[, flags])</span><br><span class="line"><span class="comment"># 例如</span></span><br><span class="line">pt = re.compile(<span class="string">r'\d+'</span>)</span><br><span class="line">m = pt.match(<span class="string">"abcd"</span>)</span><br></pre></td></tr></table></figure>
<p>findall()在字符串中找到正则表达式所匹配的所有子串，并返回一个列表。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pt.findall(string[, pos[, endpos]])</span><br><span class="line"><span class="comment"># 例如</span></span><br><span class="line">pt = re.compile(pattern[, flags])</span><br><span class="line">pt.findall(<span class="string">"abcd"</span>)</span><br></pre></td></tr></table></figure>
<p>split 方法按照能够匹配的子串将字符串分割后返回列表</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.split(pattern, string[, maxsplit=<span class="number">0</span>, flags=<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<p><a href="https://regexone.com/" target="_blank" rel="noopener">正则表达式练习</a></p>
<h3 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h3><h4 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h4><p>HTTP请求头部格式为：<code>HTTP 字段名: 字段内容</code>，主要有以下几种：</p>
<table>
<thead>
<tr>
<th>头部</th>
<th>描述</th>
<th>头部</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content-type:text/html</td>
<td>请求的MIME信息</td>
<td>Expires: Date</td>
<td>响应过期的日期和时间</td>
</tr>
<tr>
<td>Location: URL</td>
<td>重定向接收方到非请求URL的位置</td>
<td>Last-modified: Date</td>
<td>请求资源的最后修改时间</td>
</tr>
<tr>
<td>Content-length: N</td>
<td>请求的内容长度</td>
<td>Set-Cookie: String</td>
<td>设置Http Cookie</td>
</tr>
</tbody>
</table>
<p>HTTP响应头部还包括了：</p>
<ul>
<li>Allow：服务器支持的协议</li>
<li>Content-Encoding：编码</li>
<li>Location：如果是重定向301，则跳转到该页面</li>
<li>Date：服务器时间</li>
<li>Last-Modified：文档最后修改时间</li>
<li>Server：服务器名字</li>
<li>Set-Cookie：设置cookie</li>
</ul>
<p>比较复杂的是Content-type，它包含：</p>
<ul>
<li>text/html ： HTML格式</li>
<li>text/plain ：纯文本格式</li>
<li>text/xml ： XML格式</li>
<li>image/gif ：gif图片格式</li>
<li>image/jpeg ：jpg图片格式</li>
<li>image/png：png图片格式</li>
<li>application/xhtml+xml：XHTML格式</li>
<li>application/xml：XML数据格式</li>
<li>application/atom+xml：Atom XML聚合格式</li>
<li>application/json：JSON数据格式</li>
<li>application/pdf：pdf格式</li>
<li>application/msword：Word文档格式</li>
<li>application/octet-stream：二进制流数据（如常见的文件下载）</li>
<li>multipart/form-data：需要在表单中进行文件上传时，就需要使用该格式</li>
</ul>
<h4 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h4><p>Socket API 中定义的协议族（family）参数是指调用者期待返回的套接字地址结构的类型，主要包含（AF有时也写作PF）：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">AF_UNSPEC <span class="number">0</span>  <span class="comment">/* 未指定 */</span> </span><br><span class="line">AF_UNIX <span class="number">1</span>    <span class="comment">/* Unix domain sockets */</span></span><br><span class="line">AF_LOCAL <span class="number">1</span>   <span class="comment">/* POSIX name for AF_UNIX */</span></span><br><span class="line">AF_INET <span class="number">2</span>    <span class="comment">/* IPv4 */</span></span><br><span class="line">AF_AX25 <span class="number">3</span>    <span class="comment">/* 业余无线电 AX.25 */</span></span><br><span class="line">AF_IPX <span class="number">4</span>     <span class="comment">/* Novell IPX */</span></span><br><span class="line">AF_APPLETALK <span class="number">5</span><span class="comment">/* AppleTalk 地址 */</span></span><br><span class="line">AF_NETROM <span class="number">6</span>  <span class="comment">/* 业余无线电 NET/ROM */</span></span><br><span class="line">AF_BRIDGE <span class="number">7</span>  <span class="comment">/* 多协议网桥 */</span></span><br><span class="line">AF_ATMPVC <span class="number">8</span>  <span class="comment">/* ATM PVCs */</span></span><br><span class="line">AF_X25 <span class="number">9</span>     <span class="comment">/* 保留 for X.25 project */</span></span><br><span class="line">AF_INET6 <span class="number">10</span>  <span class="comment">/* IPv6 */</span></span><br><span class="line">AF_ROSE <span class="number">11</span>   <span class="comment">/* 业余无线电 X.25 PLP */</span></span><br><span class="line">AF_DECnet <span class="number">12</span> <span class="comment">/* 保留 for DECnet project */</span></span><br><span class="line">AF_NETBEUI <span class="number">13</span><span class="comment">/* 保留 for 802.2LLC project*/</span></span><br><span class="line">AF_SECURITY <span class="number">14</span><span class="comment">/* Security callback pseudo AF */</span></span><br><span class="line">AF_KEY <span class="number">15</span>     <span class="comment">/* PF_KEY key management API */</span></span><br><span class="line">AF_NETLINK <span class="number">16</span>  <span class="comment">/* Only for Linux */</span></span><br><span class="line">AF_ROUTE AF_NETLINK <span class="comment">/* Alias to emulate 4.4BSD */</span></span><br><span class="line">AF_PACKET <span class="number">17</span>  <span class="comment">/* Packet family */</span></span><br><span class="line">AF_ASH <span class="number">18</span>     <span class="comment">/* Ash */</span></span><br><span class="line">AF_ECONET <span class="number">19</span>  <span class="comment">/* Acorn Econet */</span></span><br><span class="line">AF_ATMSVC <span class="number">20</span>  <span class="comment">/* ATM SVCs */</span></span><br><span class="line">AF_RDS <span class="number">21</span>     <span class="comment">/* RDS sockets */</span></span><br><span class="line">AF_SNA <span class="number">22</span>     <span class="comment">/* Linux SNA Project (nutters!) */</span></span><br><span class="line">AF_IRDA <span class="number">23</span>    <span class="comment">/* IRDA sockets */</span></span><br><span class="line">AF_PPPOX <span class="number">24</span>   <span class="comment">/* PPPoX sockets */</span></span><br><span class="line">AF_WANPIPE <span class="number">25</span> <span class="comment">/* Wanpipe API Sockets */</span></span><br><span class="line">AF_LLC <span class="number">26</span>     <span class="comment">/* Linux LLC */</span></span><br><span class="line">AF_IB <span class="number">27</span>      <span class="comment">/* Native InfiniBand address */</span></span><br><span class="line">AF_CAN <span class="number">29</span>     <span class="comment">/* Controller Area Network      */</span></span><br><span class="line">AF_TIPC <span class="number">30</span>    <span class="comment">/* TIPC sockets */</span></span><br><span class="line">AF_BLUETOOTH <span class="number">31</span><span class="comment">/* Bluetooth sockets */</span></span><br><span class="line">AF_IUCV <span class="number">32</span>    <span class="comment">/* IUCV sockets */</span></span><br><span class="line">AF_RXRPC <span class="number">33</span>   <span class="comment">/* RxRPC sockets */</span></span><br><span class="line">AF_ISDN <span class="number">34</span>    <span class="comment">/* mISDN sockets */</span></span><br><span class="line">AF_PHONET <span class="number">35</span>  <span class="comment">/* Phonet sockets */</span></span><br><span class="line">AF_IEEE802154 <span class="number">36</span><span class="comment">/* IEEE802154 sockets */</span></span><br><span class="line">AF_CAIF <span class="number">37</span>    <span class="comment">/* CAIF sockets */</span></span><br><span class="line">AF_ALG <span class="number">38</span>     <span class="comment">/* Algorithm sockets */</span></span><br><span class="line">AF_NFC <span class="number">39</span>     <span class="comment">/* NFC sockets */</span></span><br><span class="line">AF_VSOCK <span class="number">40</span>   <span class="comment">/* vSockets */</span></span><br><span class="line">AF_MAX <span class="number">41</span>     <span class="comment">/* 保留 */</span></span><br></pre></td></tr></table></figure>
<p><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.net.sockets.addressfamily?view=netframework-4.8" target="_blank" rel="noopener">参考</a></p>
<p>定义的类型（type）包含：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SOCK_STREAM = <span class="number">1</span>,   <span class="comment">// TCP</span></span><br><span class="line">SOCK_DGRAM = <span class="number">2</span>,    <span class="comment">// UDP</span></span><br><span class="line">SOCK_RAW = <span class="number">3</span>,      <span class="comment">// 原始类型，可以自定义</span></span><br><span class="line">SOCK_RDM = <span class="number">4</span>,      <span class="comment">// 提供可靠的数据包连接</span></span><br><span class="line">SOCK_SEQPACKET= <span class="number">5</span>, <span class="comment">// 提供连续可靠的数据包连接</span></span><br><span class="line">SOCK_DCCP = <span class="number">6</span>,     <span class="comment">// 数据报拥塞控制协议，具有内置拥塞控制的不可靠数据报的传输</span></span><br><span class="line">SOCK_PACKET = <span class="number">10</span>,  <span class="comment">// 与网络驱动程序直接通信</span></span><br></pre></td></tr></table></figure>
<p>定义的协议（protocol）包含：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span></span><br><span class="line">&#123;</span><br><span class="line">    IPPROTO_IP = <span class="number">0</span>,         <span class="comment">/* Dummy protocol for TCP       */</span></span><br><span class="line">    IPPROTO_ICMP = <span class="number">1</span>,       <span class="comment">/* Internet Control Message Protocol    */</span></span><br><span class="line">    IPPROTO_IGMP = <span class="number">2</span>,       <span class="comment">/* Internet Group Management Protocol   */</span></span><br><span class="line">    IPPROTO_IPIP = <span class="number">4</span>,       <span class="comment">/* IPIP tunnels (older KA9Q tunnels use 94) */</span></span><br><span class="line">    IPPROTO_TCP = <span class="number">6</span>,        <span class="comment">/* Transmission Control Protocol    */</span></span><br><span class="line">    IPPROTO_EGP = <span class="number">8</span>,        <span class="comment">/* Exterior Gateway Protocol        */</span></span><br><span class="line">    IPPROTO_PUP = <span class="number">12</span>,       <span class="comment">/* PUP protocol             */</span></span><br><span class="line">    IPPROTO_UDP = <span class="number">17</span>,       <span class="comment">/* User Datagram Protocol       */</span></span><br><span class="line">    IPPROTO_IDP = <span class="number">22</span>,       <span class="comment">/* XNS IDP protocol         */</span></span><br><span class="line">    IPPROTO_DCCP = <span class="number">33</span>,      <span class="comment">/* Datagram Congestion Control Protocol */</span></span><br><span class="line">    IPPROTO_RSVP = <span class="number">46</span>,      <span class="comment">/* RSVP protocol            */</span></span><br><span class="line">    IPPROTO_GRE = <span class="number">47</span>,       <span class="comment">/* Cisco GRE tunnels (rfc 1701,1702)    */</span></span><br><span class="line">    IPPROTO_IPV6 = <span class="number">41</span>,      <span class="comment">/* IPv6-in-IPv4 tunnelling      */</span></span><br><span class="line">    IPPROTO_ESP = <span class="number">50</span>,           <span class="comment">/* Encapsulation Security Payload protocol */</span></span><br><span class="line">    IPPROTO_AH = <span class="number">51</span>,                <span class="comment">/* Authentication Header protocol       */</span></span><br><span class="line">    IPPROTO_BEETPH = <span class="number">94</span>,            <span class="comment">/* IP option pseudo header for BEET */</span></span><br><span class="line">    IPPROTO_PIM    = <span class="number">103</span>,       <span class="comment">/* Protocol Independent Multicast   */</span></span><br><span class="line">    IPPROTO_COMP   = <span class="number">108</span>,           <span class="comment">/* Compression Header protocol */</span></span><br><span class="line">    IPPROTO_SCTP   = <span class="number">132</span>,       <span class="comment">/* Stream Control Transport Protocol    */</span></span><br><span class="line">    IPPROTO_UDPLITE = <span class="number">136</span>,      <span class="comment">/* UDP-Lite (RFC 3828)          */</span></span><br><span class="line">    IPPROTO_RAW  = <span class="number">255</span>,     <span class="comment">/* Raw IP packets           */</span></span><br><span class="line">    IPPROTO_MAX</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>在Python中，主要的使用方式如下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socket.socket([family[, type[, proto]]])</span><br></pre></td></tr></table></figure>
<p>family，套接字协议族，常见有：</p>
<ul>
<li>socket.AF_UNIX：只能够用于单一的Unix系统进程间通信</li>
<li>socket.AF_INET：服务器之间网络通信，IPv4</li>
<li>socket.AF_INET6：服务器之间网络通信，IPv6</li>
</ul>
<p>type: 套接字类型，包括：</p>
<ul>
<li>socket.SOCK_STREAM：流式socket，用于TCP</li>
<li>socket.SOCK_DGRAM：数据报式socket，用于UDP</li>
<li>socket.SOCK_SEQPACKET：可靠的连续数据包服务</li>
<li>socket.SOCK_RAW：原始套接字，普通的套接字无法处理ICMP、IGMP等网络报文，而SOCK_RAW可以；其次，SOCK_RAW也可以处理特殊的IPv4报文；此外，利用原始套接字，可以通过IP_HDRINCL套接字选项由用户构造IP头。</li>
</ul>
<p>protocol: 写 0 即可</p>
<p>连接方面：</p>
<ul>
<li>s.bind()：绑定地址到套接字，IPv4下，使用<code>(host, port)</code>绑定。</li>
<li>s.listen()：开启TCP监听。</li>
<li>s.accept()：等待连接（阻塞）。</li>
<li>s.connect()：主动连接服务器，IPv4下，使用<code>(host, port)</code>，如果连接失败，返回<code>socket.error</code>。</li>
<li>s.connect_ex()：主动连接服务器，出错时返回出错码。</li>
<li>s.close()：关闭套接字。</li>
<li>s.getpeername()：返回远程地址。</li>
<li>s.getsockname()：返回自己的地址。</li>
<li>s.settimeout(timeout)：设置超时时间，例如连接等待时间。</li>
<li>s.gettimeout()：获取超时时间。</li>
</ul>
<p>数据传输：</p>
<ul>
<li>s.recv()：接收TCP数据，可以指定最大接收量。</li>
<li>s.send()：发送TCP数据，返回发送的字节数。</li>
<li>s.sendall()：发送完整TCP数据，如果失败抛出异常。</li>
<li>s.recvfrom()：接收UDP数据，返回(data, address)。</li>
<li>s.sendto()：发送UDP数据，参数为(data, (ip, port))，返回发送的字节数。</li>
<li>s.setsockopt(level,optname,value)：设置套接字。</li>
<li>s.getsockopt(level,optname[.buflen])：获取设置。</li>
<li>s.fileno()：返回套接字的文件描述符。</li>
<li>s.setblocking(flag)：设置为非阻塞模式。</li>
<li>s.makefile()：创建套接字文件。</li>
</ul>
<h4 id="uWSGI"><a href="#uWSGI" class="headerlink" title="uWSGI"></a>uWSGI</h4><p>uWSGI 是Python搭建Web服务所用的中间件，是调和Web服务于Web应用直接的协议问题。</p>
<p>首先安装uWSGI：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install uwsgi</span><br><span class="line"><span class="comment"># uwsgitop 用于监控数据</span></span><br><span class="line">pip install uwsgitop</span><br></pre></td></tr></table></figure></p>
<p>假设当前Nginx配置为：<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line">    <span class="attribute">include</span> uwsgi_params;</span><br><span class="line">    <span class="attribute">uwsgi_pass</span> <span class="number">127.0.0.1:3031</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我们启动一个uWSGI服务：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --processes 添加更多的进程，用于并发</span></span><br><span class="line"><span class="comment"># --threads 添加更多的线程，用于并发</span></span><br><span class="line"><span class="comment"># --stats 使用 stats 子系统，可以执行监控任务 (uwsgitop)</span></span><br><span class="line"><span class="comment"># --http-socket 启动地址，结合Nginx用</span></span><br><span class="line"><span class="comment"># --wsgi-file 指定入口文件</span></span><br><span class="line"><span class="comment"># --chdir 指定项目目录，如Django项目目录</span></span><br><span class="line">uwsgi --http-socket 127.0.0.1:3031 --<span class="built_in">chdir</span> /home/foobar/myproject/ --wsgi-file myproject/wsgi.py --master --processes 4 --threads 2 --stats 127.0.0.1:9191</span><br></pre></td></tr></table></figure></p>
<p>也可以写成配置文件：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[uwsgi]</span></span><br><span class="line"><span class="attr">socket</span> = <span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">3031</span></span><br><span class="line"><span class="attr">chdir</span> = /home/foobar/myproject/</span><br><span class="line"><span class="attr">wsgi-file</span> = myproject/wsgi.py</span><br><span class="line"><span class="attr">processes</span> = <span class="number">4</span></span><br><span class="line"><span class="attr">threads</span> = <span class="number">2</span></span><br><span class="line"><span class="attr">stats</span> = <span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">9191</span></span><br></pre></td></tr></table></figure></p>
<p>接着执行：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uwsgi yourfile.ini</span><br></pre></td></tr></table></figure></p>
<p>如果不用Django框架，而是单独文件<code>server.py</code>，或是Flask框架：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uWSGI Python 加载器将会搜索的默认函数 application </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">application</span><span class="params">(env, start_response)</span>:</span></span><br><span class="line">    start_response(<span class="string">'200 OK'</span>, [(<span class="string">'Content-Type'</span>,<span class="string">'text/html'</span>)])</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">b"Hello World"</span>]</span><br></pre></td></tr></table></figure></p>
<h3 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h3><p>Python代码的执行由Python虚拟机（也叫解释器主循环）来控制。Python在设计之初就考虑到要在主循环中，同时只有一个线程在执行。虽然 Python 解释器中可以“运行”多个线程，但在任意时刻只有一个线程在解释器中运行。对Python虚拟机的访问由全局解释器锁(GIL)来控制，正是这个锁能保证同一时刻只有一个线程在运行。也就是说，<strong>尽管有了线程模块，Python几乎依然是单线程处理</strong>。</p>
<p>尽管如此，在IO密集型的多线程应用中，Python的多线程threading库表现却依然还行。但在并行计算型应用中，如果想真正实现多线程，就得在Python中可以使用多线程threading，并自行设计锁结构，或使用多进程multiprocessing，并在主进程设置消息队列，共享内存，管道等方式传递数据。</p>
<h4 id="threading-模块"><a href="#threading-模块" class="headerlink" title="threading 模块"></a>threading 模块</h4><p>创建线程，可以直接使用：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sayhi</span><span class="params">(name)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'%s say hello'</span> %name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t=Thread(target=sayhi,args=(<span class="string">'egon'</span>,))</span><br><span class="line">    t.start()</span><br><span class="line">    print(<span class="string">'主线程'</span>)</span><br></pre></td></tr></table></figure>
<p>也可以通过子类继承后使用：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sayhi</span><span class="params">(Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,name)</span>:</span></span><br><span class="line">        super().__init__()</span><br><span class="line">        self.name=name</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">'%s say hello'</span> % self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t = Sayhi(<span class="string">'egon'</span>)</span><br><span class="line">    t.start()</span><br><span class="line">    print(<span class="string">'主线程'</span>)</span><br></pre></td></tr></table></figure>
<p>Thead 对象的常用方法有：</p>
<ul>
<li>isAlive()：是否运行</li>
<li>getName()：获取线程名称</li>
<li>setName()：设置线程名称</li>
<li>x.join()：当前线程等待x线程结束再继续执行。</li>
<li>setDaemon(True)：设置为守护线程</li>
</ul>
<p><strong>守护线性</strong>：如果设置一个线程为守护线程，就表示这个线程是不重要的，在进程退出的时候，不用等待这个线程退出。主线程只会等待所有非守护线程都结束后才退出。</p>
<p>threading 模块的常用方法有：</p>
<ul>
<li>threading.currentThread(): 返回当前的线程变量。</li>
<li>threading.enumerate(): 返回一个包含正在运行的线程的list。正在运行指线程启动后、结束前，不包括启动前和终止后的线程。</li>
<li>threading.activeCount(): 返回正在运行的线程数量，与len(threading.enumerate())有相同的结果。</li>
</ul>
<p>使用 <strong>同步锁</strong> 可以防止数据竞争问题：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">R = threading.Lock()</span><br><span class="line">R.acquire()</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">临界区</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">R.release()</span><br></pre></td></tr></table></figure></p>
<p>但是使用锁的时候，一定要解决好死锁的问题。解决方法可以参考《操作系统》相关章节。</p>
<p>线程间通信，可以使用消息队列，可以使用共享内存的方式进行通信。下面使用队列方式通信（注意互斥访问队列）：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># JoinableQueue</span></span><br><span class="line"><span class="comment"># 队列长度，多线程下不够准确</span></span><br><span class="line">Queue.qsize()</span><br><span class="line"><span class="comment"># 队列判空</span></span><br><span class="line">Queue.empty()</span><br><span class="line"><span class="comment"># 队列判满</span></span><br><span class="line">Queue.full()</span><br><span class="line"><span class="comment"># 入队，是否阻塞</span></span><br><span class="line">Queue.put(item, block=<span class="literal">True</span>, timeout=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 入队，不阻塞</span></span><br><span class="line">Queue.put_nowait(item)</span><br><span class="line"><span class="comment"># 出队，是否阻塞</span></span><br><span class="line">Queue.get(block=<span class="literal">True</span>, timeout=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 出队，不阻塞</span></span><br><span class="line">Queue.get_nowait()</span><br><span class="line"><span class="comment"># 提示让出队列，提示join停止阻塞</span></span><br><span class="line">Queue.task_done()</span><br><span class="line"><span class="comment"># 阻塞直到队列为空</span></span><br><span class="line">Queue.join()</span><br></pre></td></tr></table></figure>
<h4 id="multiprocessing-模块"><a href="#multiprocessing-模块" class="headerlink" title="multiprocessing 模块"></a>multiprocessing 模块</h4><p>多进程的创建：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'hello'</span>,os.getpid())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 会发现每一个进程都有不同的 PID</span></span><br><span class="line">    <span class="comment"># 且进程的数据各自保留一份，互不相关</span></span><br><span class="line">    <span class="comment"># 之间传递数据必须使用工具</span></span><br><span class="line">    p1=Process(target=work)</span><br><span class="line">    p2=Process(target=work)</span><br><span class="line">    p1.start()</span><br><span class="line">    p2.start()</span><br><span class="line">    print(<span class="string">'主线程/主进程pid'</span>,os.getpid())</span><br></pre></td></tr></table></figure>
<p>创建共享内存实现主进程与子进程通信：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(a)</span>:</span></span><br><span class="line">    a[<span class="number">0</span>] = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建共享内存</span></span><br><span class="line">arr = multiprocessing.Array(<span class="string">'i'</span>, range(<span class="number">10</span>))</span><br><span class="line"><span class="comment"># 子进程处理</span></span><br><span class="line">p = multiprocessing.Process(target=f, args=(arr,))</span><br><span class="line">p.start()</span><br><span class="line">p.join()</span><br><span class="line">print(arr[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<p>使用Manger通信，本质也是共享内存：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(ls)</span>:</span></span><br><span class="line">    ls.append(<span class="string">'Hello'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Manager 要在主进程创建</span></span><br><span class="line">server = multiprocessing.Manager()</span><br><span class="line"><span class="comment"># 每调用一次list产生一个共享内存</span></span><br><span class="line"><span class="comment"># 除了list外，也可以是其他形式，如队列、锁、字典、数组等</span></span><br><span class="line">ls = server.list()</span><br><span class="line"><span class="comment"># ls = server.Queue()</span></span><br><span class="line"><span class="comment"># 子进程处理</span></span><br><span class="line">proc = multiprocessing.Process(target=f, args=(ls,))</span><br><span class="line">proc.start()</span><br><span class="line">proc.join()</span><br><span class="line">print(ls)</span><br></pre></td></tr></table></figure></p>
<h4 id="ctypes"><a href="#ctypes" class="headerlink" title="ctypes"></a>ctypes</h4><p>ctypes可以让Python直接调用任意的C动态库的导出函数，由于ctypes会在调用C函数前释放GIL，因此也可以实现多线程。</p>
<p>我们可以将写好的Task编译为C的动态库，例如<code>lib_task.so</code>或<code>lib_task.dll</code>，然后在Python中调用该库。打包动态库可以使用Visual Studio建立相关项目，Visual Studio就会自动生成一个DLL模板。或使用GCC创建：</p>
<p><code>lib_task.h</code><br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> LIB_TASK_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LIB_TASK_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">" C "</span> &#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// DLL 关键字 __declspec (dllexport)</span></span><br><span class="line"><span class="keyword">extern</span> __declspec (dllexport) <span class="function"><span class="keyword">void</span> <span class="title">Task</span><span class="params">(<span class="keyword">int</span> arg)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></p>
<p><code>lib_task.c</code><br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"print.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在这里实现多线程</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Task</span><span class="params">(<span class="keyword">int</span> arg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(arg);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>编辑DLL：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc --share lib_task.c -o lib_task.dll</span><br></pre></td></tr></table></figure></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"><span class="comment"># lib_task.h 与 lib_task.dll 必须在这个目录下</span></span><br><span class="line"><span class="comment"># 给DLL传递参数时，要将参数转化为C的类型</span></span><br><span class="line">lib = cdll.LoadLibrary(<span class="string">"lib_task.dll"</span>)</span><br><span class="line">t = Thread(target=lib.Task, args=(<span class="number">1</span>,))</span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line">lib.Task()</span><br></pre></td></tr></table></figure>
<h4 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h4><p>线程池可以帮助我们自动调度线程，在需要多线程任务量巨大的情况下是非常好用的工具，省去我们考虑线程同步的问题，也节省了上下文切换的时间。</p>
<p>第三方线程池 threadpool：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install threadpool</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threadpool <span class="keyword">import</span> ThreadPool, makeRequests</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个容纳4个线程的线程池</span></span><br><span class="line">pool = ThreadPool(<span class="number">4</span>)</span><br><span class="line">requests = makeRequests(</span><br><span class="line">    some_callable,   <span class="comment"># 多线程的任务</span></span><br><span class="line">    list_of_args,    <span class="comment"># 参数</span></span><br><span class="line">    callback         <span class="comment"># 回调函数，可空</span></span><br><span class="line">    )</span><br><span class="line"><span class="keyword">for</span> req <span class="keyword">in</span> requests:</span><br><span class="line">    pool.putRequest(req) </span><br><span class="line"><span class="comment"># 等待线程池完成任务</span></span><br><span class="line">pool.wait()</span><br></pre></td></tr></table></figure>
<p>另外还有ThreadPoolExecutor，ProcessPoolExecutor，线程（进程）池也可以使用。</p>
<p>Executor提供了以下常用的方法：</p>
<p><code>submit(fn, *args,**kwargs)</code>：将fn函提交给池子；*args是传给fn函数的参数；**kwargs表示以关键字的形式为fn的参数。</p>
<p><code>map(func, *iterables, timeout=None, chunksize=1)</code>：类似于全局函数的map，只是该函数将会启动多个线程，以异步的方式立即对*iterables执行map处理，就是把for循环和submit结合在一起了。</p>
<p><code>shutdown(wait=True)</code>：关闭池子，wait=True时等待池内所有任务执行完毕回收完资源后才继续；wait=False时立即返回，并不会等待池内的任务执行完毕；但不管wait参数为何值，整个程序都会等到所有任务执行完毕才会清空池子，所以submit和map必须在shutdown之前执行。</p>
<p>​程序将task函数submit之后，submit会返回一个Future对象，Future类主要用于获取线程或进程任务函数的返回值。Future中提供了一下方法：</p>
<p><code>cancel()</code>：取消Future代表的线程或者进程任务，如果任务正在执行，不可取消，返回False；否则任务取消，返回Ture。</p>
<p><code>cancelled()</code>：返回Future代表的任务是否被成功取消。</p>
<p><code>running()</code>：返回Future代表的任务是否增正在执行。</p>
<p><code>done()</code>：返回Future代表的任务是否已经结束。</p>
<p><code>result(timmeout=None)</code>：返回Future代表的任务的结果，如果任务没有完成，该方法将会阻塞当前线程，timeout指定阻塞多长时间。</p>
<p><code>exception()</code>：返回Future代表的任务的异常，如果没有异常，则返回None。</p>
<p><code>add_done_callback(fn)</code>：给Future代表的任务加一个’回调函数’，当该任务成功之后，执行这个fn函数。</p>
<p>创建线程池 ThreadPoolExecutor：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time,threading</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(n)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">f"线程号 <span class="subst">&#123;threading.get_ident()&#125;</span>"</span>,n)</span><br><span class="line">    <span class="keyword">return</span> n*n</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 创建线程池，线程数 5</span></span><br><span class="line">    t_pool = ThreadPoolExecutor(max_workers=<span class="number">5</span>)</span><br><span class="line">    t_l = list()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">        t = t_pool.submit(f,i)</span><br><span class="line">        t_l.append(t)</span><br><span class="line">    t_pool.shutdown()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> t_l:</span><br><span class="line">        print(<span class="string">'==='</span>,i.result())</span><br></pre></td></tr></table></figure>
<p>创建进程池 ProcessPoolExecutor：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time,threading</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ProcessPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback_fun</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(n)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">f"进程PID <span class="subst">&#123;os.getpid()&#125;</span>"</span>,n)</span><br><span class="line">    <span class="keyword">return</span> n*n</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 创建进程池，进程数 5</span></span><br><span class="line">    p_pool = ProcessPoolExecutor(max_workers=<span class="number">5</span>)</span><br><span class="line">    p_l = list()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        t = p_pool.submit(f,i)</span><br><span class="line">        <span class="comment"># 也可以设置回调函数，回调的参数由任务函数提供</span></span><br><span class="line">        <span class="comment"># t.add_done_callback(callback_fun)</span></span><br><span class="line">        p_l.append(t)</span><br><span class="line">    <span class="comment"># 也可以写成</span></span><br><span class="line">    <span class="comment"># s = p_pool.map(f,range(1,5))   </span></span><br><span class="line">    p_pool.shutdown(wait = <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> p_l:</span><br><span class="line">        print(<span class="string">'==='</span>,i.result())</span><br></pre></td></tr></table></figure>
<p>multiprocessing 模块也提供了进程池：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,time</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process,Pool</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(n)</span>:</span></span><br><span class="line">    print(<span class="string">f"进程PID <span class="subst">&#123;os.getpid()&#125;</span>"</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> n*n  <span class="comment"># 返回值交给回调函数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cb_fun</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 创建工作进程</span></span><br><span class="line">    p = Pool(<span class="number">3</span>)  </span><br><span class="line">    p_l = list()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        re = p.apply(</span><br><span class="line">            f,              <span class="comment"># 多线程工作函数</span></span><br><span class="line">            args=(i,),      <span class="comment"># 传递的参数</span></span><br><span class="line">            callback=cb_fun <span class="comment"># 回调函数</span></span><br><span class="line">        )</span><br><span class="line">        p_l.append(re)</span><br><span class="line">    print(p_l)</span><br><span class="line">    p_l.close()</span><br><span class="line">    p_l.join()</span><br></pre></td></tr></table></figure>
<h3 id="XML-与-JSON"><a href="#XML-与-JSON" class="headerlink" title="XML 与 JSON"></a>XML 与 JSON</h3><h4 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h4><p>XML 指可扩展标记语言（eXtensible Markup Language），形式同HTML，是一种用于标记电子文件使其具有结构性的标记语言。XML也可以用于数据以文本格式存储下来。格式如下（DOM）：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">collection</span> <span class="attr">shelf</span>=<span class="string">"New Arrivals"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span> <span class="attr">title</span>=<span class="string">"Enemy Behind"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">type</span>&gt;</span>War, Thriller<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">format</span>&gt;</span>DVD<span class="tag">&lt;/<span class="name">format</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">year</span>&gt;</span>2003<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">rating</span>&gt;</span>PG<span class="tag">&lt;/<span class="name">rating</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">stars</span>&gt;</span>10<span class="tag">&lt;/<span class="name">stars</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">description</span>&gt;</span>Talk about a US-Japan war<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span> <span class="attr">title</span>=<span class="string">"Transformers"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">type</span>&gt;</span>Anime, Science Fiction<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">format</span>&gt;</span>DVD<span class="tag">&lt;/<span class="name">format</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">year</span>&gt;</span>1989<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">rating</span>&gt;</span>R<span class="tag">&lt;/<span class="name">rating</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">stars</span>&gt;</span>8<span class="tag">&lt;/<span class="name">stars</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">description</span>&gt;</span>A schientific fiction<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">movie</span> <span class="attr">title</span>=<span class="string">"Trigun"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">type</span>&gt;</span>Anime, Action<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">format</span>&gt;</span>DVD<span class="tag">&lt;/<span class="name">format</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">episodes</span>&gt;</span>4<span class="tag">&lt;/<span class="name">episodes</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">rating</span>&gt;</span>PG<span class="tag">&lt;/<span class="name">rating</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">stars</span>&gt;</span>10<span class="tag">&lt;/<span class="name">stars</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">description</span>&gt;</span>Vash the Stampede!<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">movie</span> <span class="attr">title</span>=<span class="string">"Ishtar"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">type</span>&gt;</span>Comedy<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">format</span>&gt;</span>VHS<span class="tag">&lt;/<span class="name">format</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">rating</span>&gt;</span>PG<span class="tag">&lt;/<span class="name">rating</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">stars</span>&gt;</span>2<span class="tag">&lt;/<span class="name">stars</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">description</span>&gt;</span>Viewable boredom<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movie</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>解析 XML 可以使用 SAX 模块，SAX 模块用事件驱动模型，通过在解析 XML 的过程中触发一个个的事件并调用用户定义的回调函数来处理 XML 文件。SAX 模块非常适用于对大型文件进行处理，且只需要文件部分信息时使用。</p>
<p>通过使用ContentHandler类读取数据。ContentHandler的方法有：</p>
<ul>
<li>startDocument()：文档启动时调用。</li>
<li>endDocument()：到达结尾时调用。</li>
<li>startElement(name, attrs)：遇到开始标签&lt;..&gt;调用。</li>
<li>endElement(name)：遇到结束标签&lt;/..&gt;调用。</li>
<li>characters(content)：分情况看，有<ul>
<li>从行开始，遇到标签之前，若存在字符，则content的值为这些字符串。</li>
<li>从一个标签，遇到下一个标签之前，若存在字符，则content的值为这些字符串。</li>
<li>从一个标签，遇到行结束符之前，若存在字符，则content的值为这些字符串。</li>
<li>标签可以是开始标签，也可以是结束标签。</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.sax</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MovieHandler</span><span class="params">( xml.sax.ContentHandler )</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span>  <span class="comment"># 此处定义对象属性</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># 元素开始调用</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startElement</span><span class="params">(self, tag, attributes)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># 元素结束调用</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">endElement</span><span class="params">(self, tag)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># 读取字符时调用</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">characters</span><span class="params">(self, content)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建XML阅读器</span></span><br><span class="line">parser = xml.sax.make_parser()</span><br><span class="line"><span class="comment"># 关闭命名空间</span></span><br><span class="line">parser.setFeature(xml.sax.handler.feature_namespaces, <span class="number">0</span>)</span><br><span class="line"><span class="comment"># 创建对象</span></span><br><span class="line">Handler = MovieHandler()</span><br><span class="line"><span class="comment"># 设置XML阅读器</span></span><br><span class="line">parser.setContentHandler(Handler)</span><br><span class="line"><span class="comment"># 开始解析</span></span><br><span class="line">parser.parse(<span class="string">"movies.xml"</span>)</span><br></pre></td></tr></table></figure>
<p>如果解析的文件不大，且需要文件的全部信息，可以使用DOM解析器。这个解析器可以一次性将整个文档读入内存，且可读可写到文件。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xml.dom.minidom <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">import</span> xml.dom.minidom</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用minidom解析器打开 XML 文档</span></span><br><span class="line">DOMTree = xml.dom.minidom.parse(<span class="string">"movies.xml"</span>)</span><br><span class="line">collection = DOMTree.documentElement</span><br><span class="line"><span class="keyword">if</span> collection.hasAttribute(<span class="string">"shelf"</span>):</span><br><span class="line">   <span class="keyword">print</span> (<span class="string">f"Root element : <span class="subst">&#123;collection.getAttribute(<span class="string">'shelf'</span>)&#125;</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在集合中获取所有电影</span></span><br><span class="line">movies = collection.getElementsByTagName(<span class="string">"movie"</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Json"><a href="#Json" class="headerlink" title="Json"></a>Json</h4><p>JSON (JavaScript Object Notation) 是一种轻量级的数据交换格式，适合于网络间传输数据，如前后端使用Ajax传输，则偏向于传输Json。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'no'</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="string">'name'</span> : <span class="string">'Runoob'</span>,</span><br><span class="line">    <span class="string">'url'</span> : <span class="string">'http://www.runoob.com'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python 字典类型转换为 JSON 对象</span></span><br><span class="line">json_str = json.dumps(data)</span><br><span class="line"><span class="comment"># 将 JSON 对象转换为 Python 字典</span></span><br><span class="line">data = json.loads(json_str)</span><br></pre></td></tr></table></figure>
<h3 id="GUI-编程"><a href="#GUI-编程" class="headerlink" title="GUI 编程"></a>GUI 编程</h3><h4 id="Tkinter"><a href="#Tkinter" class="headerlink" title="Tkinter"></a>Tkinter</h4><h4 id="PyQt"><a href="#PyQt" class="headerlink" title="PyQt"></a>PyQt</h4><h4 id="wxPython"><a href="#wxPython" class="headerlink" title="wxPython"></a>wxPython</h4><h4 id="Pyside"><a href="#Pyside" class="headerlink" title="Pyside"></a>Pyside</h4><h2 id="数据与科学计算"><a href="#数据与科学计算" class="headerlink" title="数据与科学计算"></a>数据与科学计算</h2><h3 id="爬虫"><a href="#爬虫" class="headerlink" title="爬虫"></a>爬虫</h3><h4 id="Robots-协议"><a href="#Robots-协议" class="headerlink" title="Robots 协议"></a>Robots 协议</h4><p>Robots 协议指定了一个网站可以爬取的信息，例如：<br><code>http://www.taobao.com/robots.txt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">User-agent:  Baiduspider</span><br><span class="line">Allow:  /article</span><br><span class="line">Allow:  /oshtml</span><br><span class="line">Allow:  /ershou</span><br><span class="line">Allow: /$</span><br><span class="line">Disallow:  /product/</span><br><span class="line">Disallow:  /</span><br><span class="line"></span><br><span class="line">User-Agent:  *</span><br><span class="line">Disallow:  /</span><br><span class="line"></span><br><span class="line"># 站点信息</span><br><span class="line">Sitemap: ...</span><br></pre></td></tr></table></figure>
<p>使用爬虫技术，需要注意应：</p>
<ul>
<li>要伪装User-Agent，且需要多个，随机选取</li>
<li>对参数进行URL编码</li>
<li>注意是否是通过AJAX传输数据</li>
<li>保存服务器下发的Cookies</li>
</ul>
<h4 id="URL-Lib-包"><a href="#URL-Lib-包" class="headerlink" title="URL Lib 包"></a>URL Lib 包</h4><p><code>urllib.request</code>，负责读写 url。<br><code>urllib.error</code>，定义错误与异常。<br><code>urllib.parse</code>，url参数的编码解码。<br><code>urllib.robotparser</code>，用于分析robots.txt文件。</p>
<p>简单的读写URL：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen, Request</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接打开一个url，Request对象，返回HTTPResponse对象，用法类似文件</span></span><br><span class="line">res = urlopen(url, data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造Request</span></span><br><span class="line">req = Request(url, headers=&#123;</span><br><span class="line">    <span class="string">'User-agent'</span>: <span class="string">'user agent'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment"># 或 req.add_header('', '')</span></span><br><span class="line">res = urlopen(req)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看结果</span></span><br><span class="line">res.closed  <span class="comment"># 查看是否关闭，False</span></span><br><span class="line"><span class="keyword">with</span> res:</span><br><span class="line">    res.status   <span class="comment"># 状态码</span></span><br><span class="line">    res.reason   <span class="comment"># 状态</span></span><br><span class="line">    res.getrul() <span class="comment"># 真正的URL，例如重定向后的URL</span></span><br><span class="line">    res.info()   <span class="comment"># headers</span></span><br><span class="line">    res.read()   <span class="comment"># 返回读取的内容</span></span><br><span class="line">res.closed  <span class="comment"># 查看是否关闭，True</span></span><br></pre></td></tr></table></figure>
<p>URL参数的编码解码：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line">d = &#123;</span><br><span class="line">    <span class="string">'id'</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'auther'</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># url编码</span></span><br><span class="line">arg = parse.urlencode(d)</span><br><span class="line"><span class="comment"># url解码</span></span><br><span class="line">d = parse.unquote(arg)</span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">url = <span class="string">f"http://...?<span class="subst">&#123;arg&#125;</span>"</span>   <span class="comment"># GET</span></span><br><span class="line"><span class="comment"># 或 urlopen(req, arg.encode())  POST</span></span><br></pre></td></tr></table></figure>
<p><a href="http://httpbin.org" target="_blank" rel="noopener">HTTP 实验网站</a></p>
<h4 id="AJAX-与-HTTPS"><a href="#AJAX-与-HTTPS" class="headerlink" title="AJAX 与 HTTPS"></a>AJAX 与 HTTPS</h4><p>在Chrome浏览器里，进入开发者选项，选择XHR分类，查看异步请求。利用其中的AJAX接口进行数据请求。</p>
<p>HTTPS是由权威机构颁发的证书，颁发的证书文件需要事先上传至被认证的服务器上。当用户访问网站时，用户浏览器会首先得到该网站的服务器证书，用户拿到证书后进行验证，进而判断通信是否安全。</p>
<p>在爬虫中，我们会遇到拥有HTTPS但是不信任的网站，因此要尽量忽略HTTPS以减少工作量。</p>
<p>使用SSL模块忽略HTTPS：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略不信任的证书</span></span><br><span class="line">context = ssl._create_unverified_context()</span><br><span class="line"><span class="keyword">with</span> urlopen(req, context = context) <span class="keyword">as</span> res:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<h4 id="urllib-3"><a href="#urllib-3" class="headerlink" title="urllib 3"></a>urllib 3</h4><p>urllib 3库是一个第三方库，提供了例如连接池管理等功能。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install urllib3</span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开一个 URL 池管理器</span></span><br><span class="line"><span class="keyword">with</span> urllib3.PoolManager() <span class="keyword">as</span> http:</span><br><span class="line">    <span class="comment"># http.urlopen()</span></span><br><span class="line">    resp = http.request()</span><br><span class="line">    <span class="comment"># resp.status</span></span><br><span class="line">    <span class="comment"># resp.reason</span></span><br><span class="line">    <span class="comment"># resp.headers</span></span><br><span class="line">    <span class="comment"># resp.data</span></span><br></pre></td></tr></table></figure>
<h4 id="requests-库"><a href="#requests-库" class="headerlink" title="requests 库"></a>requests 库</h4><p>requests库是基于urllib3库的，而且提供了更加友好的API使用。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install requests</span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">resp = requests.request(<span class="string">'GET'</span>, url, headers=&#123;</span><br><span class="line">        <span class="string">'User-Agent'</span>: ua</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> resp:</span><br><span class="line">    <span class="comment"># resp.url</span></span><br><span class="line">    <span class="comment"># resp.status_code</span></span><br><span class="line">    <span class="comment"># resp.request.headers</span></span><br><span class="line">    <span class="comment"># resp.text</span></span><br><span class="line">    <span class="comment"># resp.cookies</span></span><br></pre></td></tr></table></figure>
<p>使用带Cookie的访问：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> request.Session() <span class="keyword">as</span> session:</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">        resp = session.get(url, headers=&#123;<span class="string">''</span>,<span class="string">''</span>&#125;)</span><br><span class="line">        <span class="keyword">with</span> resp:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<h4 id="XPATH-技术"><a href="#XPATH-技术" class="headerlink" title="XPATH 技术"></a>XPATH 技术</h4><p>XPath是用来在XML中查找信息的语言。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bookstore</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在XPath中定义了节点：</p>
<ul>
<li>元素：<code>&lt;title lang=&quot;en&quot;&gt;Harry Potter&lt;/title&gt;</code></li>
<li>属性：<code>lang=&quot;en&quot;</code></li>
<li>文本：</li>
<li>命名空间：<code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</code></li>
<li>处理指令</li>
<li>注释</li>
<li>文档节点：<code>&lt;bookstore&gt;</code></li>
</ul>
<p>也包含节点关系，如：父，子，兄弟，所有祖先，所有后代。</p>
<p>在XPath中，节点之间的父子关系可以用表达式表示：</p>
<ul>
<li><code>nodename</code>：选取此节点的所有子节点</li>
<li><code>/</code>：根节点或分隔符 </li>
<li><code>//</code>：后继节点，不考虑路径</li>
<li><code>.</code>：当前节点</li>
<li><code>..</code>：父节点</li>
<li><code>@</code>：属性</li>
<li><code>|</code>：选取多个路径</li>
</ul>
<p>谓语是用于按照索引选择子节点的工具：</p>
<ul>
<li><code>[1]</code>：第一个元素</li>
<li><code>[last()]</code>：最后一个元素</li>
<li><code>[position()&lt;3]</code>：前两个元素</li>
<li><code>[@lang]</code>：拥有lang属性的元素</li>
<li><code>[@lang=&#39;eng&#39;]</code>：满足条件的元素</li>
<li><code>[price&gt;10]</code>：元素值大于10的元素</li>
</ul>
<p>通配符：</p>
<ul>
<li><code>*</code>：任何元素节点</li>
<li><code>@*</code>：任何属性节点</li>
<li><code>node()</code>：任何类型节点</li>
</ul>
<p>轴可定义相对于当前节点的节点集：</p>
<ul>
<li>ancestor：选取当前节点的所有祖先（父、祖父等）。</li>
<li>ancestor-or-self：选取当前节点的所有祖先（父、祖父等）以及当前节点本身。</li>
<li>attribute：选取当前节点的所有属性。</li>
<li>child：选取当前节点的所有子元素。</li>
<li>descendant：选取当前节点的所有后代元素（子、孙等）。</li>
<li>descendant-or-self：选取当前节点的所有后代元素（子、孙等）以及当前节点本身。</li>
<li>following：选取文档中当前节点的结束标签之后的所有节点。</li>
<li>namespace：选取当前节点的所有命名空间节点。</li>
<li>parent：选取当前节点的父节点。</li>
<li>preceding：选取文档中当前节点的开始标签之前的所有节点。</li>
<li>preceding-sibling：选取当前节点之前的所有同级节点。</li>
<li>self：选取当前节点。</li>
</ul>
<p>使用轴可以选取某些节点：</p>
<ul>
<li>child::book：选取所有属于当前节点的子元素的 book 节点。</li>
<li>child::text()：选取当前节点的所有文本子节点。</li>
</ul>
<p>安装 lxml 模块：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># linux 需要依赖</span></span><br><span class="line">sudo apt-get install libxml2-dev libxslt-dev </span><br><span class="line"><span class="comment"># windows 不需要</span></span><br><span class="line">pip install lxml</span><br></pre></td></tr></table></figure></p>
<p>使用：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建标签</span></span><br><span class="line">root = etree.Element(<span class="string">'html'</span>)</span><br><span class="line">body = etree.Element(<span class="string">'body'</span>)</span><br><span class="line">root.append(body)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印HTML</span></span><br><span class="line">print(etree.tostring(root))</span><br><span class="line">print(etree.tostring(</span><br><span class="line">    root,</span><br><span class="line">    pretty_print=<span class="literal">True</span></span><br><span class="line">).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加子元素</span></span><br><span class="line">sub = etree.SubElement(body, <span class="string">'child1'</span>)</span><br><span class="line">sub = etree.SubElement(body, <span class="string">'child2'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解析HTML</span></span><br><span class="line">etree.HTML(text)</span><br><span class="line">a_node.xpath(<span class="string">'xpath 路径'</span>)</span><br></pre></td></tr></table></figure>
<p>在Chrome使用XPath工具：在选定的标签上右键-&gt;Copy-&gt;XPath，并根据给定的内容进行修改。也可以使用插件<code>ChroPath</code>调试。</p>
<p>在分析选定标签的时候，可以优先找id属性，其次class属性。</p>
<p>示例：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'https://moive.douban.com'</span></span><br><span class="line">ua = <span class="string">''</span></span><br><span class="line"><span class="keyword">with</span> requests.get(</span><br><span class="line">    url,</span><br><span class="line">    headers=&#123;<span class="string">'User-Agent'</span>: ua&#125;</span><br><span class="line">) <span class="keyword">as</span> response:</span><br><span class="line">    <span class="comment"># HTML 内容</span></span><br><span class="line">    content = response.txt</span><br><span class="line">    <span class="comment"># 解析为 DOM</span></span><br><span class="line">    html = etree.HTML(content)</span><br><span class="line">    <span class="comment"># 使用XPath得到内容</span></span><br><span class="line">    titles = html.xpath(<span class="string">"//div[@class='villboard-bd']//tr/td/a/text()"</span>)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> titles:</span><br><span class="line">        print(item)</span><br></pre></td></tr></table></figure>
<p><a href="https://www.w3school.com.cn/xpath/index.asp" target="_blank" rel="noopener">XPath 语言</a></p>
<h4 id="Spider"><a href="#Spider" class="headerlink" title="Spider"></a>Spider</h4><h3 id="数据分析与可视化"><a href="#数据分析与可视化" class="headerlink" title="数据分析与可视化"></a>数据分析与可视化</h3><p>安装环境：</p>
<p>编辑<code>requirements.txt</code>文件，安装依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">matplotlib==2.2.2 # 画图工具</span><br><span class="line">numpy=1.14.2      # 运算工具</span><br><span class="line">pandas==0.20.3    # 数据处理工具</span><br><span class="line">TA-Lib==0.4.16  # 技术指标库</span><br><span class="line">tables==3.4.2   # 读取 hdf5</span><br><span class="line">jupyter=1.0.0   # 展示数据平台</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>
<h4 id="Jupyter-Notebook"><a href="#Jupyter-Notebook" class="headerlink" title="Jupyter Notebook"></a>Jupyter Notebook</h4><p>原名Ipython Notebook，是一个基于Web的Python IDE，支持Julia，Python，R三种语言，在画图、数据展示方面非常方便。</p>
<p>运行Jupyter：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter notebook</span><br></pre></td></tr></table></figure></p>
<p>默认在<a href="http://localhost:8888" target="_blank" rel="noopener">http://localhost:8888</a>打开IDE。</p>
<p>Cell：一对In Out称为Cell。有编辑模式和命令模式，类似与Vim。</p>
<p>编辑快捷键：</p>
<ul>
<li>Shift + Enter：执行，并下移</li>
<li>Ctrl + Enter：执行，不移动</li>
</ul>
<p>命令快捷键：</p>
<ul>
<li>A：在上方添加Cell</li>
<li>B：在下方添加Cell</li>
<li>D + D：删除Cell</li>
</ul>
<p>Markdown：在上方改为标记。</p>
<h4 id="Matplotlib"><a href="#Matplotlib" class="headerlink" title="Matplotlib"></a>Matplotlib</h4><p>Matplotlib是用来开发2D，3D图表的工具。可以参考Echarts。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># 魔法函数：仅仅在IPython中使用，此句表示可以内嵌绘图，并且可以省略掉plt.show()这一步。</span></span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line">plt.figure()</span><br><span class="line">plt.plot(</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>],  <span class="comment"># 横坐标</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>]   <span class="comment"># 纵坐标</span></span><br><span class="line">)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>Matplotlib有三层结构：</p>
<ul>
<li>容器层：提供画板（Canvas），画布（Figure）以及绘图区/坐标系（Axes，SubPlot）。</li>
<li>辅助显示层：显示图例，刻度，网格等内容。</li>
<li>图像层：显示图像的内容。</li>
</ul>
<p>常用方法有：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义数据</span></span><br><span class="line">x = range(<span class="number">10</span>)</span><br><span class="line">y = [random.uniform(<span class="number">10</span>, <span class="number">20</span>) <span class="keyword">for</span> i <span class="keyword">in</span> x]   <span class="comment"># uniform 均匀分布</span></span><br><span class="line"></span><br><span class="line">x_labels = [<span class="string">f"11:<span class="subst">&#123;i:<span class="number">02</span>&#125;</span>"</span> <span class="keyword">for</span> i <span class="keyword">in</span> x]    <span class="comment"># 设置步长为 5</span></span><br><span class="line">y_labels = range(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">u = range(<span class="number">10</span>)</span><br><span class="line">v = [random.uniform(<span class="number">40</span>, <span class="number">50</span>) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建画布  容器层</span></span><br><span class="line">plt.figure(</span><br><span class="line">    figsize=(<span class="number">20</span>, <span class="number">8</span>),  <span class="comment"># 图像的尺寸</span></span><br><span class="line">    dpi=<span class="number">300</span>  <span class="comment"># 图像的DPI</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建折线图  图像层</span></span><br><span class="line">plt.plot(x, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加坐标轴刻度</span></span><br><span class="line">plt.xticks(x[::<span class="number">5</span>], x_labels[::<span class="number">5</span>])</span><br><span class="line">plt.yticks(y[::<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加网格</span></span><br><span class="line">plt.grid(</span><br><span class="line">    <span class="literal">True</span>,              <span class="comment"># 是否显示</span></span><br><span class="line">    linestyle=<span class="string">'--'</span>,    <span class="comment"># 形状</span></span><br><span class="line">    alpha=<span class="number">0.3</span>          <span class="comment"># 透明度</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加标题</span></span><br><span class="line">plt.xlabel(<span class="string">"Time"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Temp"</span>)</span><br><span class="line">plt.title(<span class="string">"The Plot"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加多条曲线  图像层</span></span><br><span class="line">plt.plot(u, v, color=<span class="string">"r"</span>, linestyle=<span class="string">"--"</span>, label=<span class="string">"CN"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 图例，要求plot必须设置label属性</span></span><br><span class="line">plt.legend(loc=<span class="string">"lower left"</span>)  <span class="comment"># 显示位置</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存图像</span></span><br><span class="line">plt.savefig(path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示图像，并释放资源</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>如果绘制多个图像：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置 1 x 2 的绘图区，用法类似于plot</span></span><br><span class="line">figure, axes = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">axes[<span class="number">0</span>].plot(x, y)</span><br><span class="line">axes[<span class="number">1</span>].plot(u, v)</span><br><span class="line"></span><br><span class="line">axes[<span class="number">0</span>].legend()</span><br><span class="line">axes[<span class="number">1</span>].legend()</span><br><span class="line"></span><br><span class="line">axes[<span class="number">0</span>].grid(<span class="literal">True</span>)</span><br><span class="line">axes[<span class="number">1</span>].grid(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">axes[<span class="number">0</span>].set_xticks()</span><br><span class="line">axes[<span class="number">1</span>].set_xticks()</span><br><span class="line"></span><br><span class="line">axes[<span class="number">0</span>].set_xlabel()</span><br><span class="line">axes[<span class="number">1</span>].set_xlabel()</span><br></pre></td></tr></table></figure>
<p>也可以画其他图像。</p>
<p>散点图（scatter）：观察数据的分布规律<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(x, y)</span><br></pre></td></tr></table></figure></p>
<p>柱状图（bar）：统计对比数据<br>单柱：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plt.bar(x, y, </span><br><span class="line">    width=<span class="number">0.5</span>,       <span class="comment"># 柱状图宽度</span></span><br><span class="line">    align=<span class="string">'center'</span>, <span class="comment"># 对齐方式</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>多柱：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">plt.bar(x, y1, </span><br><span class="line">    width=<span class="number">0.2</span>,       <span class="comment"># 柱状图宽度</span></span><br><span class="line">    align=<span class="string">'center'</span>, <span class="comment"># 对齐方式</span></span><br><span class="line">)</span><br><span class="line">plt.bar([i+<span class="number">0.1</span> <span class="keyword">for</span> i <span class="keyword">in</span> x], y2, </span><br><span class="line">    width=<span class="number">0.2</span>,       <span class="comment"># 柱状图宽度</span></span><br><span class="line">    align=<span class="string">'center'</span>, <span class="comment"># 对齐方式</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>直方图（histogram）：反应一组连续数据的分布</p>
<p>组数 = 极差 / 组距 = (max - min) / bins</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">distance = <span class="number">3</span></span><br><span class="line">bins = (max(x) - min(x)) // distance</span><br><span class="line"></span><br><span class="line">plt.hist(x, </span><br><span class="line">    bins=bins,</span><br><span class="line">    density=<span class="literal">True</span>  <span class="comment"># 是否显示频率</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">plt.xticks(range(min(x), max(x) + <span class="number">2</span>, distance))</span><br></pre></td></tr></table></figure>
<p>饼图（pie）：分类数据的占比情况<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plt.pie(x, </span><br><span class="line">    labels=bins,      <span class="comment"># 每部分名称</span></span><br><span class="line">    autopct=<span class="string">"%1.2f%%"</span> <span class="comment"># 占比显示格式</span></span><br><span class="line">)</span><br><span class="line">plt.axis(<span class="string">'equal'</span>)     <span class="comment"># 变圆</span></span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure></p>
<p>如果无法正常显示中文，可以增加配置：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>]=[<span class="string">'SimHei'</span>] <span class="comment">#解决中文显示</span></span><br><span class="line">plt.rcParams[<span class="string">'axes.unicode_minus'</span>] = <span class="literal">False</span> <span class="comment">#解决符号无法显示</span></span><br></pre></td></tr></table></figure>
<p>或是一劳永逸的（Windows）：</p>
<p>删除~/.matplotlib/下的缓存文件；<br>新增~/.matplotlib/matplotlibrc配置文件，修改内容为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">backend:TkAgg</span><br><span class="line">font.famly: sans-serif</span><br><span class="line">font.sans-serif: SimHei</span><br><span class="line">axes.unicode_minus: False</span><br></pre></td></tr></table></figure>
<h3 id="Numpy"><a href="#Numpy" class="headerlink" title="Numpy"></a>Numpy</h3><p>Numpy 是一款高效的运算工具，用于快速处理任意维度的数据。</p>
<h4 id="ndarray"><a href="#ndarray" class="headerlink" title="ndarray"></a>ndarray</h4><p>数组：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">score = np.array([</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">])  <span class="comment"># ndarray 类型，2维</span></span><br><span class="line"></span><br><span class="line">score = np.array([</span><br><span class="line">    [</span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    ]</span><br><span class="line">], dtype=np.int32)    <span class="comment"># 3维，,32位int</span></span><br></pre></td></tr></table></figure>
<p>ndarray在底层使用C语言编写，内部解除了GIL，因此效率大大增加。ndarray因此也支持了向量化运算。</p>
<p>ndarray 包含了几种属性：</p>
<ul>
<li>ndarray.shape：数组维度的元组（“m行n列”等描述）</li>
<li>ndarray.ndim：数组维度</li>
<li>ndarray.size：元素数量</li>
<li>ndarray.itemsize：每个元素的长度</li>
<li>ndarray.dtype：元素类型，如np.bool，np.int32，np.uint16，np.float64，np.complex64，np.object，np.string，np.unicode等</li>
</ul>
<h4 id="数组操作"><a href="#数组操作" class="headerlink" title="数组操作"></a>数组操作</h4><p>数组的生成：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全0数组，也可以加dtpye，order参数</span></span><br><span class="line">np.zeros(shape)</span><br><span class="line"><span class="comment"># 全1数组</span></span><br><span class="line">np.ones(shape)</span><br><span class="line"><span class="comment"># 现有数组生成</span></span><br><span class="line">np.array(list)  <span class="comment"># 深拷贝数组</span></span><br><span class="line">np.copy(a)      <span class="comment"># 深拷贝数组</span></span><br><span class="line">np.asarray(a)   <span class="comment"># 浅拷贝数组</span></span><br><span class="line"><span class="comment"># 生成固定范围的数组</span></span><br><span class="line">np.linspace(<span class="number">0</span>, <span class="number">100</span>, <span class="number">7</span>)   <span class="comment"># 0到100，7个数，闭区间</span></span><br><span class="line">np.arange(<span class="number">0</span>, <span class="number">100</span>, <span class="number">7</span>)     <span class="comment"># 0到100，步长7，左闭右开</span></span><br></pre></td></tr></table></figure>
<p>随机数生成：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 均匀分布，返回0~1的一组均匀分布的数</span></span><br><span class="line">np.random.rand()</span><br><span class="line"><span class="comment"># 均匀分布，从[low,high)中随机采样，size指定输出样本数目，可以是int或元组</span></span><br><span class="line">np.random.uniform(low, high, size=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 标准正态分布，获取一个或多个样本</span></span><br><span class="line">np.random.randn()</span><br><span class="line"><span class="comment"># 正态分布，loc为均值，scale为标准差</span></span><br><span class="line">np.random.normal(loc, scale, size=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure></p>
<p>数组操作：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义</span></span><br><span class="line">data = np.array([</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>],</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择元素：二维数组，选择第一行的前三个</span></span><br><span class="line">data[<span class="number">0</span>, <span class="number">0</span>:<span class="number">3</span>]  <span class="comment"># 切片操作为左闭右开</span></span><br><span class="line"><span class="comment"># 改变形状：重新分割数据，并返回</span></span><br><span class="line">data.reshape(shape)</span><br><span class="line"><span class="comment"># 改变形状：直接改变原始数据</span></span><br><span class="line">data.resize(shape)</span><br><span class="line"><span class="comment"># 数组转置</span></span><br><span class="line">data.T()</span><br><span class="line"><span class="comment"># 类型修改</span></span><br><span class="line">data.astype(<span class="string">"int32"</span>)</span><br><span class="line"><span class="comment"># 序列化</span></span><br><span class="line">data.tostring()</span><br><span class="line"><span class="comment"># 去重</span></span><br><span class="line">np.unique(data)</span><br><span class="line"><span class="comment"># 一维化</span></span><br><span class="line">data.flatten()</span><br></pre></td></tr></table></figure>
<p>数组运算：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 逻辑运算：</span></span><br><span class="line">res = data &gt; <span class="number">2</span>  <span class="comment"># 对每一个数字做计算并返回结果</span></span><br><span class="line">data[data &gt; <span class="number">2</span>]  <span class="comment"># 返回满足条件的部分数据</span></span><br><span class="line">data[data &gt; <span class="number">2</span>] = <span class="number">1.9</span>  <span class="comment"># 对满足条件的数据做运算</span></span><br><span class="line">np.all()        <span class="comment"># 如果全部是True就返回True</span></span><br><span class="line">np.any()        <span class="comment"># 如果有True就返回True</span></span><br><span class="line">np.where(condition, a, b)  <span class="comment"># 满足condition的元素置为a，否则置为b</span></span><br><span class="line">condition = np.logical_and(con_a, con_b) <span class="comment"># 条件与运算</span></span><br><span class="line">condition = np.logical_or(con_a, con_b)  <span class="comment"># 条件或运算</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计运算：</span></span><br><span class="line">np.min(data, axis=<span class="number">-1</span>)   <span class="comment"># axis 表示按行还是按列</span></span><br><span class="line">np.max(data, axis=<span class="number">-1</span>)</span><br><span class="line">np.median()   <span class="comment"># 中位数</span></span><br><span class="line">np.mean()     <span class="comment"># 均值</span></span><br><span class="line">np.std()      <span class="comment"># 标准差</span></span><br><span class="line">np.var()      <span class="comment"># 均方差  std 的平方</span></span><br><span class="line">np.sum()</span><br><span class="line">np.argmax(data, axis=<span class="number">1</span>)  <span class="comment"># 返回最大值索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组间运算，要遵循广播机制</span></span><br><span class="line">data + <span class="number">1</span>       <span class="comment"># 对每一个元素运算</span></span><br><span class="line">data1 * data2  <span class="comment"># 对应元素运算</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 矩阵运算，此处的矩阵必须是二维数组</span></span><br><span class="line">mt = np.mat(data)  <span class="comment"># 转化为矩阵</span></span><br><span class="line"><span class="comment"># 矩阵乘法</span></span><br><span class="line">np.matmul(mt1, mt2)</span><br><span class="line">np.dot(mt1, mt2)</span><br><span class="line">mt1 * mt2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组合并</span></span><br><span class="line">np.hstack((a, b))  <span class="comment"># 水平拼接</span></span><br><span class="line">np.vstack((a, b))  <span class="comment"># 垂直拼接</span></span><br><span class="line">np.concatenate((a, b), axis=<span class="number">0</span>)  <span class="comment"># 任意拼接，需要设置轴</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组分割</span></span><br><span class="line">np.split(x, <span class="number">3</span>)    <span class="comment"># 按个数分割</span></span><br><span class="line">np.split(x, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>])  <span class="comment"># 按索引分割</span></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line"><span class="comment">#### IO操作</span></span><br><span class="line"></span><br><span class="line">读取数据：</span><br><span class="line">```py</span><br><span class="line"><span class="comment"># 无法读取字符串</span></span><br><span class="line">data = np.genfromtxt(<span class="string">"data.csv"</span>, delimiter=<span class="string">','</span>)</span><br><span class="line"><span class="comment"># 处理缺失值：直接删除缺失值，插值处理缺失</span></span><br><span class="line"><span class="comment"># 获取缺失值个数</span></span><br><span class="line">nan_num = np.count_nonzero(data[:, i][t[:, i] != t[:, i]])</span><br><span class="line"><span class="comment"># 判断缺失</span></span><br><span class="line">np.isnan(i)</span><br></pre></td></tr></table></figure></p>
<h4 id="GPU-加速"><a href="#GPU-加速" class="headerlink" title="GPU 加速"></a>GPU 加速</h4><p>首先需要<code>CUDA</code>，<code>CUDNN</code>，可以到官网下载。</p>
<p>查看本机CUDA情况可以到<code>控制面板</code>-&gt;<code>NVIDIA控制面板</code>-&gt;<code>帮助</code>-&gt;<code>系统信息</code>-&gt;<code>组件</code>里面查看。</p>
<p>通过使用Visual Studio可以开发CUDA应用，例如查看一个NVIDIA CUDA的例子：<br>使用Visual Stuido打开项目：CUDA安装目录-&gt;Samples，配置1_Utilities-&gt;deviceQuery-&gt;右键设置为启动项目，执行，就可以看到CUDA信息了。</p>
<p>安装 cupy：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For CUDA 8.0</span></span><br><span class="line">pip install cupy-cuda80</span><br><span class="line"></span><br><span class="line"><span class="comment"># For CUDA 9.0</span></span><br><span class="line">pip install cupy-cuda90</span><br><span class="line"></span><br><span class="line"><span class="comment"># For CUDA 9.1</span></span><br><span class="line">pip install cupy-cuda91</span><br><span class="line"></span><br><span class="line"><span class="comment"># For CUDA 9.2</span></span><br><span class="line">pip install cupy-cuda92</span><br><span class="line"></span><br><span class="line"><span class="comment"># For CUDA 10.0</span></span><br><span class="line">pip install cupy-cuda100</span><br><span class="line"></span><br><span class="line"><span class="comment"># For CUDA 10.1</span></span><br><span class="line">pip install cupy-cuda101</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install CuPy from source</span></span><br><span class="line">pip install cupy</span><br></pre></td></tr></table></figure>
<p>使用方法同numpy一样：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cupy <span class="keyword">as</span> cp</span><br><span class="line"><span class="comment"># numpy 用法</span></span><br><span class="line">x=np.ones((<span class="number">1024</span>,<span class="number">512</span>,<span class="number">4</span>,<span class="number">4</span>))*<span class="number">1024.</span></span><br><span class="line">y=np.ones((<span class="number">1024</span>,<span class="number">512</span>,<span class="number">4</span>,<span class="number">1</span>))*<span class="number">512.3254</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">    z=x*y</span><br><span class="line"><span class="comment"># cupy 用法</span></span><br><span class="line">x=cp.ones((<span class="number">1024</span>,<span class="number">512</span>,<span class="number">4</span>,<span class="number">4</span>))*<span class="number">1024.</span></span><br><span class="line">y=cp.ones((<span class="number">1024</span>,<span class="number">512</span>,<span class="number">4</span>,<span class="number">1</span>))*<span class="number">512.3254</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">    z=x*y</span><br></pre></td></tr></table></figure>
<h3 id="Pandas"><a href="#Pandas" class="headerlink" title="Pandas"></a>Pandas</h3><p>Pandas 也是处理数据的工具。拥有便捷的数据处理能力，读取文件也方便，同时很好的的结合了matplotlib。</p>
<h4 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h4><p>尽管numpy在数据计算方面较python原始的方法有很大优势，但是同时也缺失了数据含义的展示。因此DataFrame在这方面进行了增强。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加行列索引</span></span><br><span class="line">row_labels = [<span class="string">f"第<span class="subst">&#123;i:<span class="number">02</span>&#125;</span>"</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用日期</span></span><br><span class="line">col_labels = pd.date_range(start=<span class="string">"20200101"</span>, period=<span class="number">5</span>, freq=<span class="string">"B"</span>)</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (<span class="number">10</span>, <span class="number">5</span>)),</span><br><span class="line">    index=row_labels,  <span class="comment"># 行索引</span></span><br><span class="line">    colums=col_labels  <span class="comment"># 列索引</span></span><br><span class="line">)  <span class="comment"># 正态分布</span></span><br></pre></td></tr></table></figure>
<p>常用属性有：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data.shape</span><br><span class="line">data.index   <span class="comment"># 必须批量修改索引</span></span><br><span class="line">data.columns</span><br><span class="line">data.values  <span class="comment"># 去除索引后的数据，ndarray</span></span><br><span class="line">data.T</span><br></pre></td></tr></table></figure></p>
<p>常用方法：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">head()  <span class="comment"># 返回前几行</span></span><br><span class="line">tail()  <span class="comment"># 返回后几行</span></span><br><span class="line">reset_index(drop=<span class="literal">True</span>)  <span class="comment"># 重置索引</span></span><br><span class="line">set_index(<span class="string">"字段名"</span>, drop=<span class="literal">True</span>)  <span class="comment"># 单个索引</span></span><br><span class="line">set_index([<span class="string">"字段1"</span>, <span class="string">"字段2"</span>], drop=<span class="literal">True</span>)  <span class="comment"># 多个索引</span></span><br><span class="line"><span class="comment"># 对于多级索引还有属性：</span></span><br><span class="line">data.index.names  </span><br><span class="line">data.index.levels</span><br></pre></td></tr></table></figure></p>
<h4 id="Panel-（即将弃用）"><a href="#Panel-（即将弃用）" class="headerlink" title="Panel （即将弃用）"></a>Panel （即将弃用）</h4><p>是DataFrame的容器，是存储三维数据的结构。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pdata = pd.Panel(</span><br><span class="line">    np.arange(<span class="number">24</span>).reshape(<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>),</span><br><span class="line">    items=list(<span class="string">"ABCD"</span>),</span><br><span class="line">    major_axis=pd.date_range(<span class="string">"20200101"</span>, period=<span class="number">3</span>),</span><br><span class="line">    minor_axis=[<span class="string">'1'</span>, <span class="string">'2'</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看某一组数据</span></span><br><span class="line">pdata[<span class="string">'A'</span>]</span><br><span class="line">pdata.major_axis(<span class="string">""</span>)</span><br><span class="line">pdata.minor_axis(<span class="string">"1"</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h4><p>Series 是带索引的一维数组。</p>
<p>创建Series<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数组</span></span><br><span class="line">sr = pd.Series(np.arange(<span class="number">10</span>), index=[...])</span><br><span class="line"><span class="comment"># 或字典</span></span><br><span class="line">sr = pd.Series(&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>, <span class="string">'c'</span>: <span class="number">3</span>&#125;)</span><br><span class="line"><span class="comment"># 或已有数据</span></span><br><span class="line">sr = data.iloc[<span class="number">1</span>, :]</span><br></pre></td></tr></table></figure></p>
<p>常用属性有：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index   <span class="comment"># 索引</span></span><br><span class="line">values  <span class="comment"># 数值</span></span><br></pre></td></tr></table></figure></p>
<h4 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接索引，先列后行</span></span><br><span class="line">data[<span class="string">"字段"</span>][<span class="string">"记录"</span>]</span><br><span class="line"><span class="comment"># 按名索引</span></span><br><span class="line">data.loc[<span class="string">"记录"</span>][<span class="string">"字段"</span>]</span><br><span class="line">data.loc[<span class="string">"记录"</span>, <span class="string">"字段"</span>]</span><br><span class="line"><span class="comment"># 按数字索引</span></span><br><span class="line">data.iloc[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line"><span class="comment"># 混合索引 （即将弃用）</span></span><br><span class="line">data.ix[<span class="number">0</span>:<span class="number">4</span>, [<span class="string">"字段1"</span>, <span class="string">"字段2"</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 赋值</span></span><br><span class="line">data[<span class="string">"字段"</span>] = <span class="number">100</span>  <span class="comment"># 按列</span></span><br><span class="line">data.loc[<span class="string">"记录"</span>, <span class="string">"字段"</span>] = <span class="number">100</span>  <span class="comment"># 单个</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 排序</span></span><br><span class="line">data.sort_values(by=<span class="string">"字段"</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">data.sort_values(by=[<span class="string">"字段1"</span>, <span class="string">"字段2"</span>], ascending=<span class="literal">False</span>)</span><br><span class="line">data.sort_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 算数运算</span></span><br><span class="line">data[<span class="string">"字段"</span>] + <span class="number">3</span></span><br><span class="line">data[<span class="string">"字段"</span>].add(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逻辑运算</span></span><br><span class="line">data[data[<span class="string">"字段"</span>] &gt; <span class="number">2</span>]</span><br><span class="line">data[(data[<span class="string">"字段"</span>] &gt; <span class="number">2</span>) &amp; (data[<span class="string">"字段"</span>] &lt; <span class="number">10</span>)]</span><br><span class="line">data.query(<span class="string">"字段 &gt; 2 &amp; 字段 &lt; 10"</span>)</span><br><span class="line">data[data[<span class="string">"字段"</span>].isin([<span class="number">100</span>, <span class="number">50</span>])]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计运算</span></span><br><span class="line">min</span><br><span class="line">max</span><br><span class="line">mean</span><br><span class="line">median</span><br><span class="line">var</span><br><span class="line">std</span><br><span class="line">describe()  <span class="comment"># 获取每个字段的所有统计指标</span></span><br><span class="line">idxmax()    <span class="comment"># max的索引</span></span><br><span class="line">idxmin()   </span><br><span class="line"><span class="comment"># 累计统计函数，查看走势</span></span><br><span class="line">cumsum()</span><br><span class="line">cumsum().plot()  <span class="comment"># 顺便画图</span></span><br><span class="line">cummax()</span><br><span class="line">cummin()</span><br><span class="line">cumprod()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义运算</span></span><br><span class="line">apply(func, axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按列删除</span></span><br><span class="line">data.drop([<span class="string">"字段"</span>], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h4 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h4><p>绘图函数如：<br>DataFrame.plot()<br>Series.plot()</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># kind 参数，图像类型</span></span><br><span class="line">plot(x=<span class="string">"字段1"</span>, y=<span class="string">"字段2"</span>, kind=<span class="string">"scatter"</span>)</span><br></pre></td></tr></table></figure>
<h4 id="IO操作"><a href="#IO操作" class="headerlink" title="IO操作"></a>IO操作</h4><p>读取数据，且可以识别表头等，支持CVS，JSON，HTML，Execl，HDF5，SQL等。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取CVS</span></span><br><span class="line">data = pd.read_csv(</span><br><span class="line">    path, </span><br><span class="line">    usecols=[<span class="string">'字段1'</span>, <span class="string">'字段2'</span>],</span><br><span class="line">    names=[<span class="string">"字段名1"</span>, <span class="string">"字段名2"</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储CSV</span></span><br><span class="line">data.to_csv(</span><br><span class="line">    path, </span><br><span class="line">    columns=[<span class="string">'字段'</span>],</span><br><span class="line">    header=<span class="literal">True</span>,      <span class="comment"># 是否写入表头</span></span><br><span class="line">    mode=<span class="string">"wa"</span>,        <span class="comment"># 写模式</span></span><br><span class="line">    index=<span class="literal">True</span>        <span class="comment"># 是否写入索引</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取HDF5</span></span><br><span class="line">data = pd.read_hdf(</span><br><span class="line">    path,</span><br><span class="line">    key=[<span class="string">'字段'</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储HDF5</span></span><br><span class="line">data.to_hdf(</span><br><span class="line">    path,</span><br><span class="line">    key=[<span class="string">'字段'</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取JSON</span></span><br><span class="line">data = pd.read_json(</span><br><span class="line">    path,</span><br><span class="line">    orient=<span class="string">"records"</span>  <span class="comment"># 读入的形式，读入成记录</span></span><br><span class="line">    lines=<span class="literal">True</span>        <span class="comment"># 每一行是否有换行</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储JSON</span></span><br><span class="line">data.to_json(</span><br><span class="line">    path,</span><br><span class="line">    orient=<span class="string">"records"</span></span><br><span class="line">    lines=<span class="literal">True</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="处理缺失值"><a href="#处理缺失值" class="headerlink" title="处理缺失值"></a>处理缺失值</h4><p>当缺失的值为NAN时：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 判断是否有Null</span></span><br><span class="line">pd.isnull(data)</span><br><span class="line">pd.isnull(data).any()  <span class="comment"># 列出所有字段是否缺失</span></span><br><span class="line">pd.notnull(data)</span><br><span class="line">pd.notnull(data).all()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将所有缺失值置0</span></span><br><span class="line">data[pd.isnull(data)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除有缺失值的样本 inplace 是否修改原始 DataFrames</span></span><br><span class="line">dropna(inplace=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 替换缺失</span></span><br><span class="line">fillna(value, inplace=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 均值替换</span></span><br><span class="line">fillna(data[<span class="string">'字段'</span>].mean(), inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p>当缺失值为其他形式：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 替换</span></span><br><span class="line">replace(to_replace=<span class="string">"?"</span>, value=np.nan)</span><br></pre></td></tr></table></figure>
<h4 id="数据离散化"><a href="#数据离散化" class="headerlink" title="数据离散化"></a>数据离散化</h4><p>通过对数据分类，并按分组分别统计处理数据。<br>方式：one-hot编码（哑编码）</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分组</span></span><br><span class="line"><span class="comment"># 自动分组</span></span><br><span class="line">sr = data.qcout(data, bins)</span><br><span class="line"><span class="comment"># 自定义分组，给定边界</span></span><br><span class="line">sr = data.cut(data, [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 编码</span></span><br><span class="line">get_dummies(sr, prefix=<span class="string">''</span>)</span><br><span class="line"><span class="comment"># 查看每个分组的情况</span></span><br><span class="line">sr.value_counts()</span><br></pre></td></tr></table></figure>
<h4 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按位置拼接，如果按列拼接，要字段一致</span></span><br><span class="line">pd.concat([data1, data2], axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 按索引合并，on 索引，inner 内连接</span></span><br><span class="line">pd.merge(left, right, how=<span class="string">'inner'</span>, on=[<span class="string">'字段1'</span>, <span class="string">'字段2'</span>])</span><br></pre></td></tr></table></figure>
<h4 id="交叉表与透视表"><a href="#交叉表与透视表" class="headerlink" title="交叉表与透视表"></a>交叉表与透视表</h4><p>用于探索两个变量的关系。</p>
<p>交叉表：用于查看两列数据之间的关系</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.crosstab(data[<span class="string">'字段1'</span>], data[<span class="string">'字段2'</span>])</span><br></pre></td></tr></table></figure>
<p>透视表：也是用于查看两列数据之间的关系</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pivot_table(data[<span class="string">'字段1'</span>], data[<span class="string">'字段2'</span>])</span><br></pre></td></tr></table></figure>
<h4 id="分组与聚合"><a href="#分组与聚合" class="headerlink" title="分组与聚合"></a>分组与聚合</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据字段1分组，根据字段2聚合</span></span><br><span class="line">data.groupby(by=<span class="string">"字段1"</span>)[<span class="string">'字段2'</span>].max()</span><br><span class="line">data[<span class="string">'字段2'</span>].groupby(col[<span class="string">"字段1"</span>]).max()</span><br></pre></td></tr></table></figure>
<h2 id="常用库"><a href="#常用库" class="headerlink" title="常用库"></a>常用库</h2><h3 id="科学计算"><a href="#科学计算" class="headerlink" title="科学计算"></a>科学计算</h3><h4 id="数据收集"><a href="#数据收集" class="headerlink" title="数据收集"></a>数据收集</h4><p><a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" target="_blank" rel="noopener">Beautiful Soup</a>是一个HTML和XML解析器，可为被解析的页面创建解析树，从而用于从web页面中提取数据。从网页中提取数据的过程称为网页抓取。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install beautifulsoup4</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2015/10/beginner-guide-web-scraping-beautiful-soup-python/" target="_blank" rel="noopener">操作指南</a></p>
<p><a href="https://www.analyticsvidhya.com/blog/2015/10/beginner-guide-web-scraping-beautiful-soup-python/" target="_blank" rel="noopener">Scrapy</a>是一个用于大规模网页抓取的框架。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install scrapy</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2017/07/web-scraping-in-python-using-scrapy/" target="_blank" rel="noopener">操作方法</a></p>
<p><a href="https://www.seleniumhq.org/" target="_blank" rel="noopener">Selenium</a>是一个倍受欢迎的自动化浏览器工具。在业界常用于测试，但对于网页抓取也非常方便。</p>
<p><a href="https://www.analyticsvidhya.com/blog/2019/05/scraping-classifying-youtube-video-data-python-selenium/" target="_blank" rel="noopener">操作方法</a></p>
<h4 id="数据清零与操作"><a href="#数据清零与操作" class="headerlink" title="数据清零与操作"></a>数据清零与操作</h4><p><a href="https://pandas.pydata.org/pandas-docs/stable/" target="_blank" rel="noopener">Pandas</a>是用Python语言编写的，主要用于数据操作和数据分析。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pandas</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2016/01/12-pandas-techniques-python-data-manipulation/" target="_blank" rel="noopener">操作方法1</a></p>
<p><a href="https://www.analyticsvidhya.com/blog/2015/07/11-steps-perform-data-analysis-pandas-python/" target="_blank" rel="noopener">操作方法2</a></p>
<p><a href="https://pyod.readthedocs.io/en/latest/" target="_blank" rel="noopener">PyOD</a>用于处理异常值。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyod</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2019/02/outlier-detection-python-pyod/" target="_blank" rel="noopener">操作方法</a></p>
<p><a href="https://www.numpy.org/" target="_blank" rel="noopener">NumPy</a>可进行高速多维数组运算。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install numpy</span><br></pre></td></tr></table></figure></p>
<p><a href="https://spacy.io/" target="_blank" rel="noopener">Spacy</a>是一个非常有用且灵活的自然语言处理( NLP )库和框架，用于清理创建模型的文本文档。与类似用途的其他库相比，SpaCy速度更快。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install -U spacy</span><br><span class="line">python -m spacy download en</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2017/04/natural-language-processing-made-easy-using-spacy-%e2%80%8bin-python/" target="_blank" rel="noopener">操作方法</a></p>
<h4 id="数据可视化"><a href="#数据可视化" class="headerlink" title="数据可视化"></a>数据可视化</h4><p><a href="https://matplotlib.org/" target="_blank" rel="noopener">Matplotlib</a>是Python中最流行的数据可视化库。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install matplotlib</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2015/04/comprehensive-guide-data-exploration-sas-using-python-numpy-scipy-matplotlib-pandas/" target="_blank" rel="noopener">操作方法</a></p>
<p><a href="https://seaborn.pydata.org/" target="_blank" rel="noopener">Seaborn</a>是另一个基于matplotlib的绘图库。它是一个为绘制有吸引力的图像而提供高级接口的python库。matplotlib能实现功能，Seaborn只是以另一种更吸引人的视觉方式来实现。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install seaborn</span><br></pre></td></tr></table></figure></p>
<p><a href="https://bokeh.pydata.org/en/latest/" target="_blank" rel="noopener">Bokeh</a>是一个面向现代网页浏览器的交互式可视化库，为大量数据集提供优美的通用图形结构。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install bokeh</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2015/08/interactive-data-visualization-library-python-bokeh/" target="_blank" rel="noopener">操作方法</a></p>
<h4 id="建模"><a href="#建模" class="headerlink" title="建模"></a>建模</h4><p><a href="https://scikit-learn.org/stable/" target="_blank" rel="noopener">Scikit-learn</a>是Python构建模型中的佼佼者。支持在机器学习中执行的不同操作，如分类、回归、聚类和模型选择等。</p>
<p><a href="https://www.analyticsvidhya.com/blog/2015/01/scikit-learn-python-machine-learning-tool/" target="_blank" rel="noopener">操作方法</a></p>
<p><a href="https://www.tensorflow.org/" target="_blank" rel="noopener">TensorFlow</a>由谷歌开发，是一个流行的深度学习库，可帮助构建、培训不同模型。是一个开放源码的端到端平台。TensorFlow提供简单的模型构建，强大的机器学习生产，以及强大的实验工具和库。</p>
<p><a href="https://www.tensorflow.org/install" target="_blank" rel="noopener">安装方法</a></p>
<p><a href="https://www.analyticsvidhya.com/blog/2017/03/tensorflow-understanding-tensors-and-graphs/" target="_blank" rel="noopener">操作方法1</a><br><a href="https://www.analyticsvidhya.com/blog/2017/06/getting-started-with-deep-learning-using-keras-in-r/" target="_blank" rel="noopener">操作方法2</a></p>
<p><a href="https://pytorch.org/" target="_blank" rel="noopener">PyTorch</a>是一个基于Python的科学计算包，是NumPy的替代品，可使用GPU的强大功能。</p>
<p>· 深度学习研究型平台，拥有最大灵活性和最快速度</p>
<p><a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener">安装方法</a></p>
<p><a href="https://www.analyticsvidhya.com/blog/2018/02/pytorch-tutorial/" target="_blank" rel="noopener">操作方法1</a><br><a href="https://www.analyticsvidhya.com/blog/2019/01/guide-pytorch-neural-networks-case-studies/" target="_blank" rel="noopener">操作方法2</a></p>
<h4 id="模型解释"><a href="#模型解释" class="headerlink" title="模型解释"></a>模型解释</h4><p><a href="https://github.com/marcotcr/lime" target="_blank" rel="noopener">Lime</a>是一种算法（库），可以解释任何分类器或回归量的预测。</p>
<p>安装方法<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install lime</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2017/06/building-trust-in-machine-learning-models/" target="_blank" rel="noopener">操作方法</a></p>
<p><a href="https://github.com/h2oai/mli-resources" target="_blank" rel="noopener">H2O</a>自动化机器学习的市场领导者。提供简单的数据可视化技术，用于表示高度特征交互和非线性模型行为，通过可视化提供机器学习可解释性（MLI），说明建模结果和模型中特征的影响。</p>
<p><a href="https://www.h2o.ai/wp-content/uploads/2018/01/Machine-Learning-Interpretability-MLI_datasheet_v4-1.pdf" target="_blank" rel="noopener">操作方法</a></p>
<h4 id="语音处理"><a href="#语音处理" class="headerlink" title="语音处理"></a>语音处理</h4><p><a href="https://librosa.github.io/librosa/" target="_blank" rel="noopener">Librosa</a>是一个用于音乐和音频分析的Python库。它提供了创建音乐信息检索系统所需的构建块。</p>
<p><a href="https://librosa.github.io/librosa/install.html" target="_blank" rel="noopener">安装方法</a></p>
<p><a href="https://www.analyticsvidhya.com/blog/2017/08/audio-voice-processing-deep-learning/" target="_blank" rel="noopener">操作方法</a></p>
<p><a href="https://github.com/CPJKU/madmom" target="_blank" rel="noopener">Madmom</a>是一个用于音频数据分析的很棒的Python库。它是一个用Python编写的音频信号处理库，主要用于音乐信息检索（MIR）任务。</p>
<p>安装方法：依赖Numpy，Scipy，Cython，Mido<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install madmom</span><br></pre></td></tr></table></figure></p>
<p>测试依赖：PyTest，Fuaudio，PuFftw</p>
<p><a href="https://www.analyticsvidhya.com/blog/2018/02/audio-beat-tracking-for-music-information-retrieval/" target="_blank" rel="noopener">操作方法</a></p>
<p><a href="https://github.com/tyiannak/pyAudioAnalysis" target="_blank" rel="noopener">pyAudioAnalysis</a>是一个用于音频特征提取、分类和分段的Python库，涵盖广泛的音频分析任务，例如：</p>
<ul>
<li>对未知声音进行分类</li>
<li>检测音频故障并排除长时间录音中的静音时段</li>
<li>进行监督和非监督的分割</li>
<li>提取音频缩略图等等</li>
</ul>
<p>安装方法：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyAudioAnalysis</span><br></pre></td></tr></table></figure></p>
<h4 id="图像处理"><a href="#图像处理" class="headerlink" title="图像处理"></a>图像处理</h4><p><a href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_setup/py_intro/py_intro.html" target="_blank" rel="noopener">OpenCV-Python</a>是用于图像处理的Python API，结合了OpenCV C ++ API和Python语言的最佳特性。主要用于解决计算机视觉问题。</p>
<p>安装方法：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install opencv-python</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2018/12/introduction-face-detection-video-deep-learning-python/" target="_blank" rel="noopener">操作方法1</a><br><a href="https://www.analyticsvidhya.com/blog/2019/03/opencv-functions-computer-vision-python/" target="_blank" rel="noopener">操作方法2</a></p>
<p><a href="https://scikit-image.org/" target="_blank" rel="noopener">Scikit-image</a>是另一个用于图像处理的python库，是用于执行多个不同图像处理任务的算法集合。可用于图像分割、几何变换、色彩空间操作、分析、过滤，形态学、特征检测等等。</p>
<p>安装方法：依赖Numpy，Scipy，Joblib<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U scikit-learn</span><br></pre></td></tr></table></figure></p>
<p><a href="https://pillow.readthedocs.io/en/stable/" target="_blank" rel="noopener">Pillow</a>是从PIL（Python Imaging Library）派生出来的，在一些Linux发行版（如Ubuntu）中被用作原始PIL的替代。</p>
<p>安装方法：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install Pillow</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.analyticsvidhya.com/blog/2019/06/ai-comic-zain-issue-2-facial-recognition-computer-vision/" target="_blank" rel="noopener">操作方法</a></p>
<h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><p><a href="http://initd.org/psycopg/" target="_blank" rel="noopener">Psycopg</a>是Python编程语言中最流行的PostgreSQL（高级开源代码关系数据库）适配器。</p>
<p>安装方法：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install psycopg2</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.sqlalchemy.org/" target="_blank" rel="noopener">SQLAlchemy</a>是最流行的数据库语言。SQLAlchemy是pythonSQL工具包和对象关系映射器，它为应用程序开发人员提供了SQL的全部功能，且极具灵活性。</p>
<p>安装方法：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install SQLAlchemy</span><br></pre></td></tr></table></figure></p>
<h4 id="模型部署"><a href="#模型部署" class="headerlink" title="模型部署"></a>模型部署</h4><p><a href="http://flask.pocoo.org/docs/1.0/" target="_blank" rel="noopener">Flask</a>是一个用Python编写的Web框架，广泛用于部署数据科学模型。</p>
<p><a href="https://www.analyticsvidhya.com/blog/2017/09/machine-learning-models-as-apis-using-flask/" target="_blank" rel="noopener">操作方法</a></p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>下面的网站包含了字符编码，文件处理，图像处理，游戏与多媒体，大数据与科学计算，人工智能与机器学习，系统与命令行，数据库，Web框架，安全，GUI库等相关内容。</p>
<p><a href="https://zhuanlan.zhihu.com/p/98366871" target="_blank" rel="noopener">其他库参考</a></p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Python/" rel="tag"># Python</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/02/04/DevOps/DockerFirst/" rel="next" title="Docker">
                <i class="fa fa-chevron-left"></i> Docker
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/02/11/Others/System/" rel="prev" title="系统维护相关">
                系统维护相关 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MzY0MS8yMDE4MA=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Peng</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">27</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">48</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/yourname" title="GitHub &rarr; https://github.com/yourname" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据类型"><span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数字型"><span class="nav-text">数字型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串"><span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#常用方法"><span class="nav-text">常用方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#原始格式化字符串"><span class="nav-text">原始格式化字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#增强型格式化字符串"><span class="nav-text">增强型格式化字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#f-string"><span class="nav-text">f-string</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Unicode-字符串"><span class="nav-text">Unicode 字符串</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#列表"><span class="nav-text">列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#元组"><span class="nav-text">元组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#集合"><span class="nav-text">集合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字典"><span class="nav-text">字典</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#类型转换"><span class="nav-text">类型转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#类型注解"><span class="nav-text">类型注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内置函数"><span class="nav-text">内置函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看类型"><span class="nav-text">查看类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本操作"><span class="nav-text">基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#for-循环"><span class="nav-text">for 循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#迭代器"><span class="nav-text">迭代器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不定长传参"><span class="nav-text">不定长传参</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#匿名函数"><span class="nav-text">匿名函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#强制位置参数"><span class="nav-text">强制位置参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据结构"><span class="nav-text">数据结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#堆栈"><span class="nav-text">堆栈</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#队列"><span class="nav-text">队列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#优先队列"><span class="nav-text">优先队列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#列表推导式"><span class="nav-text">列表推导式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模块与包"><span class="nav-text">模块与包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读写文件"><span class="nav-text">读写文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OS-模块"><span class="nav-text">OS 模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#异常与断言"><span class="nav-text">异常与断言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对象"><span class="nav-text">对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#标准库"><span class="nav-text">标准库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#shutil"><span class="nav-text">shutil</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#blog"><span class="nav-text">blog</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sys"><span class="nav-text">sys</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#re"><span class="nav-text">re</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#datetime"><span class="nav-text">datetime</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据压缩"><span class="nav-text">数据压缩</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#计时器"><span class="nav-text">计时器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#测试"><span class="nav-text">测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#进阶内容"><span class="nav-text">进阶内容</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#正则表达式"><span class="nav-text">正则表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网络"><span class="nav-text">网络</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP"><span class="nav-text">HTTP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Socket"><span class="nav-text">Socket</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#uWSGI"><span class="nav-text">uWSGI</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多线程"><span class="nav-text">多线程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#threading-模块"><span class="nav-text">threading 模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#multiprocessing-模块"><span class="nav-text">multiprocessing 模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ctypes"><span class="nav-text">ctypes</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#线程池"><span class="nav-text">线程池</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML-与-JSON"><span class="nav-text">XML 与 JSON</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#XML"><span class="nav-text">XML</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Json"><span class="nav-text">Json</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GUI-编程"><span class="nav-text">GUI 编程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Tkinter"><span class="nav-text">Tkinter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PyQt"><span class="nav-text">PyQt</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#wxPython"><span class="nav-text">wxPython</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pyside"><span class="nav-text">Pyside</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据与科学计算"><span class="nav-text">数据与科学计算</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#爬虫"><span class="nav-text">爬虫</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Robots-协议"><span class="nav-text">Robots 协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#URL-Lib-包"><span class="nav-text">URL Lib 包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AJAX-与-HTTPS"><span class="nav-text">AJAX 与 HTTPS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#urllib-3"><span class="nav-text">urllib 3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#requests-库"><span class="nav-text">requests 库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XPATH-技术"><span class="nav-text">XPATH 技术</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Spider"><span class="nav-text">Spider</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据分析与可视化"><span class="nav-text">数据分析与可视化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Jupyter-Notebook"><span class="nav-text">Jupyter Notebook</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Matplotlib"><span class="nav-text">Matplotlib</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Numpy"><span class="nav-text">Numpy</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ndarray"><span class="nav-text">ndarray</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数组操作"><span class="nav-text">数组操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GPU-加速"><span class="nav-text">GPU 加速</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pandas"><span class="nav-text">Pandas</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DataFrame"><span class="nav-text">DataFrame</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Panel-（即将弃用）"><span class="nav-text">Panel （即将弃用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Series"><span class="nav-text">Series</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据操作"><span class="nav-text">数据操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#绘图"><span class="nav-text">绘图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IO操作"><span class="nav-text">IO操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#处理缺失值"><span class="nav-text">处理缺失值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据离散化"><span class="nav-text">数据离散化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#合并"><span class="nav-text">合并</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#交叉表与透视表"><span class="nav-text">交叉表与透视表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分组与聚合"><span class="nav-text">分组与聚合</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常用库"><span class="nav-text">常用库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#科学计算"><span class="nav-text">科学计算</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#数据收集"><span class="nav-text">数据收集</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据清零与操作"><span class="nav-text">数据清零与操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据可视化"><span class="nav-text">数据可视化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#建模"><span class="nav-text">建模</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#模型解释"><span class="nav-text">模型解释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#语音处理"><span class="nav-text">语音处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#图像处理"><span class="nav-text">图像处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据库"><span class="nav-text">数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#模型部署"><span class="nav-text">模型部署</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他"><span class="nav-text">其他</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Peng</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.0.1</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
  
  <script color="0,255,128" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>













  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  
    <script>
  window.livereOptions = {
    refer: '2020/02/09/BasicLanguage/PythonFirst/'
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>

  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
<script>
if ($('body').find('div.pdf').length) {
  $.ajax({
    type: 'GET',
    url: '//cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js',
    dataType: 'script',
    cache: true,
    success: function() {
      $('body').find('div.pdf').each(function(i, o) {
        PDFObject.embed($(o).attr('target'), $(o), {
          pdfOpenParams: {
            navpanes: 0,
            toolbar: 0,
            statusbar: 0,
            pagemode: 'thumbs',
            view: 'FitH'
          },
          PDFJS_URL: '/lib/pdf/web/viewer.html',
          height: $(o).attr('height') || '600px'
        });
      });
    },
  });
}
</script>


  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  



<!-- <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script> -->


</body>
</html>
